(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    210373,       4942]
NotebookOptionsPosition[    207517,       4851]
NotebookOutlinePosition[    207854,       4866]
CellTagsIndexPosition[    207811,       4863]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Random Snowflake Generator Based on Cellular Automaton\
\>", "Title",
 CellChangeTimes->{{3.606202569916601*^9, 3.60620259749817*^9}}],

Cell["\<\
Some time ago one of my friends asked me whether it is possible to design a \
cellular automaton which can generate realistic snowflakes. I recall my \
crystallography and thermodynamics knowledge and thought up a very simple yet \
impressive model.\
\>", "Text",
 CellChangeTimes->{{3.6062026718263907`*^9, 3.606202724634391*^9}, {
  3.606202776837355*^9, 3.6062028655343943`*^9}, {3.60620289765722*^9, 
  3.6062029378285017`*^9}, {3.606202973870549*^9, 3.6062030930063233`*^9}}],

Cell[CellGroupData[{

Cell["The regular triangular lattice", "Subsubsection",
 CellChangeTimes->{{3.6062052440685215`*^9, 3.6062052585023413`*^9}}],

Cell["\<\
First of all, we are trying to simulate snowflake, which is a kind of \
hexagonal crystal. So it should be best to construct our CA on a regular \
hexagonal grid, i.e. regular triangular lattice.\
\>", "Text",
 CellChangeTimes->{{3.6062032171553707`*^9, 3.6062032467900543`*^9}, {
  3.60620331518994*^9, 3.6062034358257933`*^9}, {3.606205306687084*^9, 
  3.6062053364027724`*^9}, {3.6062129452770348`*^9, 3.606212947437163*^9}}],

Cell[TextData[{
 "We all know ",
 Cell[BoxData[
  FormBox["CellularAutomaton", TraditionalForm]]],
 " inherently works on rectangle lattices (\[OpenCurlyDoubleQuote]4-lattice\
\[CloseCurlyDoubleQuote] for short), so how can we deduce a triangular \
lattice (\[OpenCurlyDoubleQuote]3-lattice\[CloseCurlyDoubleQuote] for short) \
on it? Well, the differences between rect-lattice and triangular one is just \
a geometric transformation."
}], "Text",
 CellChangeTimes->{{3.5974705215318027`*^9, 3.597470552267562*^9}, {
   3.5974707005140457`*^9, 3.5974707297967224`*^9}, {3.597470874193987*^9, 
   3.597470917508466*^9}, {3.5974709576577635`*^9, 3.5974709956339374`*^9}, {
   3.59747107953474*^9, 3.5974711613784246`*^9}, {3.59747152225108*^9, 
   3.597471590960013*^9}, 3.5974740494577312`*^9, {3.5982022489310727`*^9, 
   3.5982023068803153`*^9}, {3.5982119007041645`*^9, 3.598211901010181*^9}, {
   3.598211933264986*^9, 3.598211960259496*^9}, {3.5982120152045712`*^9, 
   3.598212019150793*^9}, {3.6062035292181*^9, 3.6062036043403673`*^9}, {
   3.606203645512706*^9, 3.606203655452276*^9}, 3.6062129557016325`*^9}],

Cell["\<\
To demonstrate that, have a look at the following 4-lattice, with a blue \
square highlighting the range-1 Moore \
neighborhood(http://mathworld.wolfram.com/MooreNeighborhood.html):\
\>", "Text",
 CellChangeTimes->{{3.5974713119190407`*^9, 3.5974714551342382`*^9}, {
   3.597471610460129*^9, 3.597471682648261*^9}, 3.5982023167278666`*^9, {
   3.5982119666268535`*^9, 3.5982119867779803`*^9}, {3.5982120245210924`*^9, 
   3.598212024689102*^9}, {3.606203675617416*^9, 3.6062036957115583`*^9}, 
   3.606203739090022*^9, {3.60620387536977*^9, 3.606203875815795*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rectangleGrid", "=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", "7"}], 
      RowBox[{"(*", 
       RowBox[{"any", " ", "odd", " ", "number"}], "*)"}], ",", 
      RowBox[{"m", "=", "7"}], 
      RowBox[{"(*", 
       RowBox[{"any", " ", "odd", " ", "number"}], "*)"}], ",", "center", ",",
       "pts"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"center", "=", 
      RowBox[{"Ceiling", "[", 
       FractionBox[
        RowBox[{"m", " ", "n"}], "2"], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pts", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Outer", "[", 
         RowBox[{"List", ",", 
          RowBox[{"Range", "[", "m", "]"}], ",", 
          RowBox[{"Range", "[", "n", "]"}]}], "]"}], ",", "1"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"GraphicsComplex", "[", 
         RowBox[{"pts", ",", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"EdgeForm", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "[", "Blue", "]"}], ",", "Thin"}], "}"}], 
             "]"}], ",", 
            RowBox[{"FaceForm", "[", 
             RowBox[{"Lighter", "[", 
              RowBox[{"Blue", ",", ".95"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"center", "-", "n", "-", "1"}], ",", 
              RowBox[{"center", "+", "n", "+", "1"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "Orange", ",", 
            RowBox[{"AbsolutePointSize", "[", "5", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Point", "[", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "@", "pts"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"EdgeForm", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Hue", "[", 
                RowBox[{".3", ",", ".2", ",", ".9"}], "]"}], ",", "Thick"}], 
              "}"}], "]"}], ",", 
            RowBox[{"FaceForm", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "[", 
                RowBox[{"Green", ",", ".8"}], "]"}], ",", 
               RowBox[{"Opacity", "[", ".5", "]"}]}], "}"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Polygon", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "-", "n", "-", "1"}], ",", 
                 RowBox[{"#", "-", "1"}], ",", 
                 RowBox[{"#", "+", "n"}], ",", 
                 RowBox[{"#", "+", "n", "+", "1"}], ",", 
                 RowBox[{"#", "+", "1"}], ",", 
                 RowBox[{"#", "-", "n"}]}], "}"}], "&"}], "@", "center"}], 
             "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"MapIndexed", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{
                   "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "Black", ",", "12"}], 
                  "]"}], ",", "#1", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1.5"}], ",", "1"}], "}"}]}], "]"}], "&"}], 
              ",", "pts"}], "]"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"EdgeForm", "[", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"poly", ",", "\[IndentingNewLine]", 
                 RowBox[{"Mouseover", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"FaceForm", "[", 
                    RowBox[{"{", 
                    RowBox[{"Opacity", "[", ".01", "]"}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"GeometricTransformation", "[", 
                    RowBox[{"poly", ",", 
                    RowBox[{"ScalingTransform", "[", 
                    RowBox[{
                    RowBox[{".5", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], ",", 
                    RowBox[{
                    "pts", "\[LeftDoubleBracket]", "#", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"FaceForm", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{"Purple", ",", ".7"}], "]"}], ",", 
                    RowBox[{"Opacity", "[", ".5", "]"}]}], "}"}], "]"}], ",", 
                    "poly"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
                "\[IndentingNewLine]", "]"}], "@", 
               RowBox[{"Polygon", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "-", "n", "-", "1"}], ",", 
                  RowBox[{"#", "-", "1"}], ",", 
                  RowBox[{"#", "+", "n"}], ",", 
                  RowBox[{"#", "+", "n", "+", "1"}], ",", 
                  RowBox[{"#", "+", "1"}], ",", 
                  RowBox[{"#", "-", "n"}]}], "}"}], "]"}]}], "&"}], "/@", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Range", "[", 
                  RowBox[{"n", " ", "m"}], "]"}], ",", "n"}], "]"}], 
               "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"2", ";;", 
                 RowBox[{"-", "2"}]}], ",", 
                RowBox[{"2", ";;", 
                 RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}], "]"}]}]}],
            "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], 
        "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", "1"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6062043328087535`*^9, 3.6062043579081783`*^9}, {
  3.6062044061699195`*^9, 3.6062045136050234`*^9}, {3.6062050215758815`*^9, 
  3.6062050272832117`*^9}, {3.606205591889287*^9, 3.606205645322323*^9}, {
  3.6062056949131346`*^9, 3.6062057216436524`*^9}}],

Cell[BoxData[
 GraphicsBox[
  GraphicsComplexBox[{{1, 1}, {1, 2}, {1, 3}, {1, 4}, {1, 5}, {1, 6}, {1, 
   7}, {2, 1}, {2, 2}, {2, 3}, {2, 4}, {2, 5}, {2, 6}, {2, 7}, {3, 1}, {3, 
   2}, {3, 3}, {3, 4}, {3, 5}, {3, 6}, {3, 7}, {4, 1}, {4, 2}, {4, 3}, {4, 
   4}, {4, 5}, {4, 6}, {4, 7}, {5, 1}, {5, 2}, {5, 3}, {5, 4}, {5, 5}, {5, 
   6}, {5, 7}, {6, 1}, {6, 2}, {6, 3}, {6, 4}, {6, 5}, {6, 6}, {6, 7}, {7, 
   1}, {7, 2}, {7, 3}, {7, 4}, {7, 5}, {7, 6}, {7, 7}}, 
   {EdgeForm[{RGBColor[
     NCache[
      Rational[1, 3], 0.3333333333333333], 
     NCache[
      Rational[1, 3], 0.3333333333333333], 1], Thickness[Tiny]}], FaceForm[
    RGBColor[0.95, 0.95, 1.]], RectangleBox[17, 33], 
    {RGBColor[1, 0.5, 0], AbsolutePointSize[5], 
     PointBox[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 
      19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 
      37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49}], 
     {EdgeForm[{Hue[0.3, 0.2, 0.9], Thickness[Large]}], FaceForm[{RGBColor[
      0.8, 1., 0.8], Opacity[0.5]}], 
      PolygonBox[{17, 24, 32, 33, 26, 18}], {InsetBox[
        StyleBox["1",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {1, 1}, {-1.5, 1}], InsetBox[
        StyleBox["2",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {1, 2}, {-1.5, 1}], InsetBox[
        StyleBox["3",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {1, 3}, {-1.5, 1}], InsetBox[
        StyleBox["4",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {1, 4}, {-1.5, 1}], InsetBox[
        StyleBox["5",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {1, 5}, {-1.5, 1}], InsetBox[
        StyleBox["6",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {1, 6}, {-1.5, 1}], InsetBox[
        StyleBox["7",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {1, 7}, {-1.5, 1}], InsetBox[
        StyleBox["8",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {2, 1}, {-1.5, 1}], InsetBox[
        StyleBox["9",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {2, 2}, {-1.5, 1}], InsetBox[
        StyleBox["10",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {2, 3}, {-1.5, 1}], InsetBox[
        StyleBox["11",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {2, 4}, {-1.5, 1}], InsetBox[
        StyleBox["12",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {2, 5}, {-1.5, 1}], InsetBox[
        StyleBox["13",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {2, 6}, {-1.5, 1}], InsetBox[
        StyleBox["14",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {2, 7}, {-1.5, 1}], InsetBox[
        StyleBox["15",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {3, 1}, {-1.5, 1}], InsetBox[
        StyleBox["16",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {3, 2}, {-1.5, 1}], InsetBox[
        StyleBox["17",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {3, 3}, {-1.5, 1}], InsetBox[
        StyleBox["18",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {3, 4}, {-1.5, 1}], InsetBox[
        StyleBox["19",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {3, 5}, {-1.5, 1}], InsetBox[
        StyleBox["20",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {3, 6}, {-1.5, 1}], InsetBox[
        StyleBox["21",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {3, 7}, {-1.5, 1}], InsetBox[
        StyleBox["22",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {4, 1}, {-1.5, 1}], InsetBox[
        StyleBox["23",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {4, 2}, {-1.5, 1}], InsetBox[
        StyleBox["24",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {4, 3}, {-1.5, 1}], InsetBox[
        StyleBox["25",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {4, 4}, {-1.5, 1}], InsetBox[
        StyleBox["26",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {4, 5}, {-1.5, 1}], InsetBox[
        StyleBox["27",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {4, 6}, {-1.5, 1}], InsetBox[
        StyleBox["28",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {4, 7}, {-1.5, 1}], InsetBox[
        StyleBox["29",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {5, 1}, {-1.5, 1}], InsetBox[
        StyleBox["30",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {5, 2}, {-1.5, 1}], InsetBox[
        StyleBox["31",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {5, 3}, {-1.5, 1}], InsetBox[
        StyleBox["32",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {5, 4}, {-1.5, 1}], InsetBox[
        StyleBox["33",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {5, 5}, {-1.5, 1}], InsetBox[
        StyleBox["34",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {5, 6}, {-1.5, 1}], InsetBox[
        StyleBox["35",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {5, 7}, {-1.5, 1}], InsetBox[
        StyleBox["36",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {6, 1}, {-1.5, 1}], InsetBox[
        StyleBox["37",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {6, 2}, {-1.5, 1}], InsetBox[
        StyleBox["38",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {6, 3}, {-1.5, 1}], InsetBox[
        StyleBox["39",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {6, 4}, {-1.5, 1}], InsetBox[
        StyleBox["40",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {6, 5}, {-1.5, 1}], InsetBox[
        StyleBox["41",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {6, 6}, {-1.5, 1}], InsetBox[
        StyleBox["42",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {6, 7}, {-1.5, 1}], InsetBox[
        StyleBox["43",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {7, 1}, {-1.5, 1}], InsetBox[
        StyleBox["44",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {7, 2}, {-1.5, 1}], InsetBox[
        StyleBox["45",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {7, 3}, {-1.5, 1}], InsetBox[
        StyleBox["46",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {7, 4}, {-1.5, 1}], InsetBox[
        StyleBox["47",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {7, 5}, {-1.5, 1}], InsetBox[
        StyleBox["48",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {7, 6}, {-1.5, 1}], InsetBox[
        StyleBox["49",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->12,
         FontColor->GrayLevel[0]], {7, 7}, {-1.5, 1}]}, 
      {EdgeForm[None], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{1, 8, 16, 17, 10, 2}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{1, 8, 16, 17, 10, 2}], {{{0.5, 0.}, {0., 0.5}}, {1., 
            1.}}]}],
        ImageSizeCache->{{84.75000000000001, 141.75}, {81.24999999999999, 
         138.25}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{2, 9, 17, 18, 11, 3}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{2, 9, 17, 18, 11, 3}], {{{0.5, 0.}, {0., 0.5}}, {1., 
            1.5}}]}],
        ImageSizeCache->{{84.75000000000001, 141.75}, {24.374999999999986`, 
         81.37499999999999}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{3, 10, 18, 19, 12, 4}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{3, 10, 18, 19, 12, 4}], {{{0.5, 0.}, {0., 0.5}}, {1., 
            2.}}]}],
        ImageSizeCache->{{84.75000000000001, 141.75}, {-32.500000000000014`, 
         24.499999999999986`}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{4, 11, 19, 20, 13, 5}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{4, 11, 19, 20, 13, 5}], {{{0.5, 0.}, {0., 0.5}}, {1., 
            2.5}}]}],
        ImageSizeCache->{{84.75000000000001, 
         141.75}, {-89.37500000000001, -32.375000000000014`}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{5, 12, 20, 21, 14, 6}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{5, 12, 20, 21, 14, 6}], {{{0.5, 0.}, {0., 0.5}}, {1., 
            3.}}]}],
        ImageSizeCache->{{84.75000000000001, 
         141.75}, {-145.75000000000006`, -88.75000000000004}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{8, 15, 23, 24, 17, 9}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{8, 15, 23, 24, 17, 9}], {{{0.5, 0.}, {0., 0.5}}, {1.5, 
            1.}}]}],
        ImageSizeCache->{{141.62500000000003`, 198.62500000000003`}, {
         81.24999999999999, 138.25}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{9, 16, 24, 25, 18, 10}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{9, 16, 24, 25, 18, 10}], {{{0.5, 0.}, {0., 0.5}}, {1.5,
             1.5}}]}],
        ImageSizeCache->{{141.62500000000003`, 198.62500000000003`}, {
         24.374999999999986`, 81.37499999999999}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{10, 17, 25, 26, 19, 11}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{10, 17, 25, 26, 19, 11}], {{{0.5, 0.}, {0., 0.5}}, {
            1.5, 2.}}]}],
        ImageSizeCache->{{141.62500000000003`, 
         198.62500000000003`}, {-32.500000000000014`, 24.499999999999986`}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{11, 18, 26, 27, 20, 12}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{11, 18, 26, 27, 20, 12}], {{{0.5, 0.}, {0., 0.5}}, {
            1.5, 2.5}}]}],
        ImageSizeCache->{{141.62500000000003`, 
         198.62500000000003`}, {-89.37500000000001, -32.375000000000014`}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{12, 19, 27, 28, 21, 13}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{12, 19, 27, 28, 21, 13}], {{{0.5, 0.}, {0., 0.5}}, {
            1.5, 3.}}]}],
        ImageSizeCache->{{141.62500000000003`, 
         198.62500000000003`}, {-145.75000000000006`, -88.75000000000004}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{15, 22, 30, 31, 24, 16}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{15, 22, 30, 31, 24, 16}], {{{0.5, 0.}, {0., 0.5}}, {2.,
             1.}}]}],
        ImageSizeCache->{{198.50000000000003`, 255.50000000000003`}, {
         81.24999999999999, 138.25}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{16, 23, 31, 32, 25, 17}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{16, 23, 31, 32, 25, 17}], {{{0.5, 0.}, {0., 0.5}}, {2.,
             1.5}}]}],
        ImageSizeCache->{{198.50000000000003`, 255.50000000000003`}, {
         24.374999999999986`, 81.37499999999999}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{17, 24, 32, 33, 26, 18}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{17, 24, 32, 33, 26, 18}], {{{0.5, 0.}, {0., 0.5}}, {2.,
             2.}}]}],
        ImageSizeCache->{{198.50000000000003`, 
         255.50000000000003`}, {-32.500000000000014`, 24.499999999999986`}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{18, 25, 33, 34, 27, 19}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{18, 25, 33, 34, 27, 19}], {{{0.5, 0.}, {0., 0.5}}, {2.,
             2.5}}]}],
        ImageSizeCache->{{198.50000000000003`, 
         255.50000000000003`}, {-89.37500000000001, -32.375000000000014`}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{19, 26, 34, 35, 28, 20}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{19, 26, 34, 35, 28, 20}], {{{0.5, 0.}, {0., 0.5}}, {2.,
             3.}}]}],
        ImageSizeCache->{{198.50000000000003`, 
         255.50000000000003`}, {-145.75000000000006`, -88.75000000000004}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{22, 29, 37, 38, 31, 23}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{22, 29, 37, 38, 31, 23}], {{{0.5, 0.}, {0., 0.5}}, {
            2.5, 1.}}]}],
        ImageSizeCache->{{255.37500000000003`, 312.375}, {81.24999999999999, 
         138.25}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{23, 30, 38, 39, 32, 24}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{23, 30, 38, 39, 32, 24}], {{{0.5, 0.}, {0., 0.5}}, {
            2.5, 1.5}}]}],
        ImageSizeCache->{{255.37500000000003`, 312.375}, {24.374999999999986`,
          81.37499999999999}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{24, 31, 39, 40, 33, 25}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{24, 31, 39, 40, 33, 25}], {{{0.5, 0.}, {0., 0.5}}, {
            2.5, 2.}}]}],
        ImageSizeCache->{{255.37500000000003`, 
         312.375}, {-32.500000000000014`, 24.499999999999986`}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{25, 32, 40, 41, 34, 26}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{25, 32, 40, 41, 34, 26}], {{{0.5, 0.}, {0., 0.5}}, {
            2.5, 2.5}}]}],
        ImageSizeCache->{{255.37500000000003`, 
         312.375}, {-89.37500000000001, -32.375000000000014`}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{26, 33, 41, 42, 35, 27}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{26, 33, 41, 42, 35, 27}], {{{0.5, 0.}, {0., 0.5}}, {
            2.5, 3.}}]}],
        ImageSizeCache->{{255.37500000000003`, 
         312.375}, {-145.75000000000006`, -88.75000000000004}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{29, 36, 44, 45, 38, 30}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{29, 36, 44, 45, 38, 30}], {{{0.5, 0.}, {0., 0.5}}, {3.,
             1.}}]}],
        ImageSizeCache->{{311.75000000000006`, 368.75000000000006`}, {
         81.24999999999999, 138.25}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{30, 37, 45, 46, 39, 31}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{30, 37, 45, 46, 39, 31}], {{{0.5, 0.}, {0., 0.5}}, {3.,
             1.5}}]}],
        ImageSizeCache->{{311.75000000000006`, 368.75000000000006`}, {
         24.374999999999986`, 81.37499999999999}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{31, 38, 46, 47, 40, 32}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{31, 38, 46, 47, 40, 32}], {{{0.5, 0.}, {0., 0.5}}, {3.,
             2.}}]}],
        ImageSizeCache->{{311.75000000000006`, 
         368.75000000000006`}, {-32.500000000000014`, 24.499999999999986`}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{32, 39, 47, 48, 41, 33}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{32, 39, 47, 48, 41, 33}], {{{0.5, 0.}, {0., 0.5}}, {3.,
             2.5}}]}],
        ImageSizeCache->{{311.75000000000006`, 
         368.75000000000006`}, {-89.37500000000001, -32.375000000000014`}}], 
       DynamicBox[If[
         CurrentValue["MouseOver"], {
          FaceForm[{
            RGBColor[0.85, 0.7, 0.85], 
            Opacity[0.5]}], 
          PolygonBox[{33, 40, 48, 49, 42, 34}]}, {
          FaceForm[{
            Opacity[0.01]}], 
          GeometricTransformationBox[
           
           PolygonBox[{33, 40, 48, 49, 42, 34}], {{{0.5, 0.}, {0., 0.5}}, {3.,
             3.}}]}],
        ImageSizeCache->{{311.75000000000006`, 
         368.75000000000006`}, {-145.75000000000006`, \
-88.75000000000004}}]}}}}],
  ImageSize->{455., Automatic},
  PlotRangePadding->1]], "Output",
 CellChangeTimes->{
  3.6062042980537786`*^9, {3.6062043349088717`*^9, 3.606204359042243*^9}, {
   3.6062044088540726`*^9, 3.6062045139970455`*^9}, {3.606205636832835*^9, 
   3.6062056462923727`*^9}, {3.606205695519169*^9, 3.606205722348693*^9}}]
}, {2}]],

Cell["\<\
Clearly there is always a hexagon (the green area) in this kind of \
neighborhood.\
\>", "Text",
 CellChangeTimes->{{3.6062037426372294`*^9, 3.606203754926923*^9}, {
  3.6062047013756914`*^9, 3.60620470794507*^9}}],

Cell["\<\
So forming a regular 3-lattice is as straightforward as doing a simple affine \
transformation (basically a shearing and a scaling):\
\>", "Text",
 CellChangeTimes->{{3.597471689943679*^9, 3.5974717266597795`*^9}, {
   3.597471768689186*^9, 3.5974718334868946`*^9}, {3.5982023799514055`*^9, 
   3.5982023842516456`*^9}, 3.598211994773428*^9, {3.598212029164352*^9, 
   3.5982120292783594`*^9}, {3.606203788964856*^9, 3.6062038728896284`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hexagonGrid", "=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"transmtr", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", 
            FractionBox["1", "2"]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           FractionBox[
            SqrtBox["3"], "2"]}], "}"}]}], "}"}]}], ",", "invmtr"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"invmtr", "=", 
      RowBox[{"Inverse", "[", "transmtr", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GeometricTransformation", "[", 
          RowBox[{"#", ",", "transmtr"}], "]"}], "&"}], ",", "rectangleGrid", 
        ",", "1"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"Text", "[", 
        RowBox[{"e_", ",", "pos_", ",", "others___"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"GeometricTransformation", "[", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"e", ",", "pos", ",", "others"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"invmtr", ",", 
           RowBox[{"pos", "-", 
            RowBox[{"invmtr", ".", "pos"}]}]}], "}"}]}], "]"}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.6062045978548098`*^9, {3.6062056577890253`*^9, 3.6062056756330442`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"MapAt", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\({1}\\)\[NoBreak] of \
\[NoBreak]\\!\\(rectangleGrid\\)\[NoBreak] does not exist. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partw\\\", \
ButtonNote -> \\\"MapAt::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.606279591474339*^9}],

Cell[BoxData[
 RowBox[{"MapAt", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"GeometricTransformation", "[", 
     RowBox[{"#1", ",", "transmtr$797"}], "]"}], "&"}], ",", "rectangleGrid", 
   ",", "1"}], "]"}]], "Output",
 CellChangeTimes->{3.6062795914919243`*^9}]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[InsetBox[
   GraphicsBox[
    GeometricTransformationBox[
     GraphicsComplexBox[{{1, 1}, {1, 2}, {1, 3}, {1, 4}, {1, 5}, {1, 6}, {1, 
      7}, {2, 1}, {2, 2}, {2, 3}, {2, 4}, {2, 5}, {2, 6}, {2, 7}, {3, 1}, {3, 
      2}, {3, 3}, {3, 4}, {3, 5}, {3, 6}, {3, 7}, {4, 1}, {4, 2}, {4, 3}, {4, 
      4}, {4, 5}, {4, 6}, {4, 7}, {5, 1}, {5, 2}, {5, 3}, {5, 4}, {5, 5}, {5, 
      6}, {5, 7}, {6, 1}, {6, 2}, {6, 3}, {6, 4}, {6, 5}, {6, 6}, {6, 7}, {7, 
      1}, {7, 2}, {7, 3}, {7, 4}, {7, 5}, {7, 6}, {7, 7}}, 
      {EdgeForm[{RGBColor[
        NCache[
         Rational[1, 3], 0.3333333333333333], 
        NCache[
         Rational[1, 3], 0.3333333333333333], 1], Thickness[Tiny]}], FaceForm[
       RGBColor[0.95, 0.95, 1.]], RectangleBox[17, 33], 
       {RGBColor[1, 0.5, 0], AbsolutePointSize[5], 
        PointBox[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 
         18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 
         35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49}], 
        {EdgeForm[{Hue[0.3, 0.2, 0.9], Thickness[Large]}], FaceForm[{RGBColor[
         0.8, 1., 0.8], Opacity[0.5]}], 
         PolygonBox[{17, 24, 32, 33, 26, 18}], {
          GeometricTransformationBox[InsetBox[
            StyleBox["1",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {1, 1}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {
              0, 2 3^Rational[-1, 2]}}, {-3^Rational[-1, 2], 1 - 2 
              3^Rational[-1, 2]}}, {{{1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-0.5773502691896258, \
-0.15470053837925168`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["2",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {1, 2}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-2) 
              3^Rational[-1, 2], 2 - 4 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-1.1547005383792517`, \
-0.30940107675850337`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["3",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {1, 3}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {
              0, 2 3^Rational[-1, 2]}}, {-3^Rational[1, 2], 3 - 2 
              3^Rational[1, 2]}}, {{{1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-1.7320508075688772`, \
-0.4641016151377544}}]], GeometricTransformationBox[InsetBox[
            StyleBox["4",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {1, 4}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-4) 
              3^Rational[-1, 2], 4 - 8 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-2.3094010767585034`, \
-0.6188021535170067}}]], GeometricTransformationBox[InsetBox[
            StyleBox["5",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {1, 5}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-5) 
              3^Rational[-1, 2], 5 - 10 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-2.886751345948129, \
-0.7735026918962582}}]], GeometricTransformationBox[InsetBox[
            StyleBox["6",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {1, 6}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-2) 
              3^Rational[1, 2], 6 - 4 3^Rational[1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-3.4641016151377544`, \
-0.9282032302755088}}]], GeometricTransformationBox[InsetBox[
            StyleBox["7",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {1, 7}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-7) 
              3^Rational[-1, 2], 7 - 14 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-4.041451884327381, \
-1.0829037686547611`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["8",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {2, 1}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {
              0, 2 3^Rational[-1, 2]}}, {-3^Rational[-1, 2], 1 - 2 
              3^Rational[-1, 2]}}, {{{1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-0.5773502691896258, \
-0.15470053837925168`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["9",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {2, 2}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-2) 
              3^Rational[-1, 2], 2 - 4 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-1.1547005383792517`, \
-0.30940107675850337`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["10",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {2, 3}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {
              0, 2 3^Rational[-1, 2]}}, {-3^Rational[1, 2], 3 - 2 
              3^Rational[1, 2]}}, {{{1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-1.7320508075688772`, \
-0.4641016151377544}}]], GeometricTransformationBox[InsetBox[
            StyleBox["11",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {2, 4}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-4) 
              3^Rational[-1, 2], 4 - 8 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-2.3094010767585034`, \
-0.6188021535170067}}]], GeometricTransformationBox[InsetBox[
            StyleBox["12",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {2, 5}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-5) 
              3^Rational[-1, 2], 5 - 10 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-2.886751345948129, \
-0.7735026918962582}}]], GeometricTransformationBox[InsetBox[
            StyleBox["13",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {2, 6}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-2) 
              3^Rational[1, 2], 6 - 4 3^Rational[1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-3.4641016151377544`, \
-0.9282032302755088}}]], GeometricTransformationBox[InsetBox[
            StyleBox["14",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {2, 7}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-7) 
              3^Rational[-1, 2], 7 - 14 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-4.041451884327381, \
-1.0829037686547611`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["15",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {3, 1}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {
              0, 2 3^Rational[-1, 2]}}, {-3^Rational[-1, 2], 1 - 2 
              3^Rational[-1, 2]}}, {{{1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-0.5773502691896258, \
-0.15470053837925168`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["16",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {3, 2}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-2) 
              3^Rational[-1, 2], 2 - 4 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-1.1547005383792517`, \
-0.30940107675850337`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["17",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {3, 3}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {
              0, 2 3^Rational[-1, 2]}}, {-3^Rational[1, 2], 3 - 2 
              3^Rational[1, 2]}}, {{{1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-1.7320508075688772`, \
-0.4641016151377544}}]], GeometricTransformationBox[InsetBox[
            StyleBox["18",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {3, 4}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-4) 
              3^Rational[-1, 2], 4 - 8 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-2.3094010767585034`, \
-0.6188021535170067}}]], GeometricTransformationBox[InsetBox[
            StyleBox["19",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {3, 5}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-5) 
              3^Rational[-1, 2], 5 - 10 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-2.886751345948129, \
-0.7735026918962582}}]], GeometricTransformationBox[InsetBox[
            StyleBox["20",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {3, 6}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-2) 
              3^Rational[1, 2], 6 - 4 3^Rational[1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-3.4641016151377544`, \
-0.9282032302755088}}]], GeometricTransformationBox[InsetBox[
            StyleBox["21",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {3, 7}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-7) 
              3^Rational[-1, 2], 7 - 14 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-4.041451884327381, \
-1.0829037686547611`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["22",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {4, 1}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {
              0, 2 3^Rational[-1, 2]}}, {-3^Rational[-1, 2], 1 - 2 
              3^Rational[-1, 2]}}, {{{1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-0.5773502691896258, \
-0.15470053837925168`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["23",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {4, 2}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-2) 
              3^Rational[-1, 2], 2 - 4 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-1.1547005383792517`, \
-0.30940107675850337`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["24",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {4, 3}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {
              0, 2 3^Rational[-1, 2]}}, {-3^Rational[1, 2], 3 - 2 
              3^Rational[1, 2]}}, {{{1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-1.7320508075688772`, \
-0.4641016151377544}}]], GeometricTransformationBox[InsetBox[
            StyleBox["25",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {4, 4}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-4) 
              3^Rational[-1, 2], 4 - 8 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-2.3094010767585034`, \
-0.6188021535170067}}]], GeometricTransformationBox[InsetBox[
            StyleBox["26",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {4, 5}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-5) 
              3^Rational[-1, 2], 5 - 10 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-2.886751345948129, \
-0.7735026918962582}}]], GeometricTransformationBox[InsetBox[
            StyleBox["27",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {4, 6}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-2) 
              3^Rational[1, 2], 6 - 4 3^Rational[1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-3.4641016151377544`, \
-0.9282032302755088}}]], GeometricTransformationBox[InsetBox[
            StyleBox["28",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {4, 7}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-7) 
              3^Rational[-1, 2], 7 - 14 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-4.041451884327381, \
-1.0829037686547611`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["29",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {5, 1}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {
              0, 2 3^Rational[-1, 2]}}, {-3^Rational[-1, 2], 1 - 2 
              3^Rational[-1, 2]}}, {{{1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-0.5773502691896258, \
-0.15470053837925168`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["30",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {5, 2}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-2) 
              3^Rational[-1, 2], 2 - 4 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-1.1547005383792517`, \
-0.30940107675850337`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["31",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {5, 3}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {
              0, 2 3^Rational[-1, 2]}}, {-3^Rational[1, 2], 3 - 2 
              3^Rational[1, 2]}}, {{{1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-1.7320508075688772`, \
-0.4641016151377544}}]], GeometricTransformationBox[InsetBox[
            StyleBox["32",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {5, 4}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-4) 
              3^Rational[-1, 2], 4 - 8 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-2.3094010767585034`, \
-0.6188021535170067}}]], GeometricTransformationBox[InsetBox[
            StyleBox["33",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {5, 5}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-5) 
              3^Rational[-1, 2], 5 - 10 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-2.886751345948129, \
-0.7735026918962582}}]], GeometricTransformationBox[InsetBox[
            StyleBox["34",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {5, 6}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-2) 
              3^Rational[1, 2], 6 - 4 3^Rational[1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-3.4641016151377544`, \
-0.9282032302755088}}]], GeometricTransformationBox[InsetBox[
            StyleBox["35",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {5, 7}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-7) 
              3^Rational[-1, 2], 7 - 14 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-4.041451884327381, \
-1.0829037686547611`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["36",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {6, 1}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {
              0, 2 3^Rational[-1, 2]}}, {-3^Rational[-1, 2], 1 - 2 
              3^Rational[-1, 2]}}, {{{1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-0.5773502691896258, \
-0.15470053837925168`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["37",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {6, 2}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-2) 
              3^Rational[-1, 2], 2 - 4 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-1.1547005383792517`, \
-0.30940107675850337`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["38",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {6, 3}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {
              0, 2 3^Rational[-1, 2]}}, {-3^Rational[1, 2], 3 - 2 
              3^Rational[1, 2]}}, {{{1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-1.7320508075688772`, \
-0.4641016151377544}}]], GeometricTransformationBox[InsetBox[
            StyleBox["39",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {6, 4}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-4) 
              3^Rational[-1, 2], 4 - 8 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-2.3094010767585034`, \
-0.6188021535170067}}]], GeometricTransformationBox[InsetBox[
            StyleBox["40",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {6, 5}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-5) 
              3^Rational[-1, 2], 5 - 10 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-2.886751345948129, \
-0.7735026918962582}}]], GeometricTransformationBox[InsetBox[
            StyleBox["41",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {6, 6}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-2) 
              3^Rational[1, 2], 6 - 4 3^Rational[1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-3.4641016151377544`, \
-0.9282032302755088}}]], GeometricTransformationBox[InsetBox[
            StyleBox["42",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {6, 7}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-7) 
              3^Rational[-1, 2], 7 - 14 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-4.041451884327381, \
-1.0829037686547611`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["43",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {7, 1}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {
              0, 2 3^Rational[-1, 2]}}, {-3^Rational[-1, 2], 1 - 2 
              3^Rational[-1, 2]}}, {{{1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-0.5773502691896258, \
-0.15470053837925168`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["44",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {7, 2}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-2) 
              3^Rational[-1, 2], 2 - 4 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-1.1547005383792517`, \
-0.30940107675850337`}}]], GeometricTransformationBox[InsetBox[
            StyleBox["45",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {7, 3}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {
              0, 2 3^Rational[-1, 2]}}, {-3^Rational[1, 2], 3 - 2 
              3^Rational[1, 2]}}, {{{1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-1.7320508075688772`, \
-0.4641016151377544}}]], GeometricTransformationBox[InsetBox[
            StyleBox["46",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {7, 4}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-4) 
              3^Rational[-1, 2], 4 - 8 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-2.3094010767585034`, \
-0.6188021535170067}}]], GeometricTransformationBox[InsetBox[
            StyleBox["47",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {7, 5}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-5) 
              3^Rational[-1, 2], 5 - 10 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-2.886751345948129, \
-0.7735026918962582}}]], GeometricTransformationBox[InsetBox[
            StyleBox["48",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {7, 6}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-2) 
              3^Rational[1, 2], 6 - 4 3^Rational[1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-3.4641016151377544`, \
-0.9282032302755088}}]], GeometricTransformationBox[InsetBox[
            StyleBox["49",
             StripOnInput->False,
             LineColor->GrayLevel[0],
             FrontFaceColor->GrayLevel[0],
             BackFaceColor->GrayLevel[0],
             GraphicsColor->GrayLevel[0],
             FontSize->12,
             FontColor->GrayLevel[0]], {7, 7}, {-1.5, 1}], 
           NCache[{{{1, 3^Rational[-1, 2]}, {0, 2 3^Rational[-1, 2]}}, {(-7) 
              3^Rational[-1, 2], 7 - 14 3^Rational[-1, 2]}}, {{{
              1, 0.5773502691896258}, {
              0, 1.1547005383792517`}}, {-4.041451884327381, \
-1.0829037686547611`}}]]}, 
         {EdgeForm[None], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{1, 8, 16, 17, 10, 2}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{1, 8, 16, 17, 10, 2}], {{{0.5, 0.}, {0., 0.5}}, {1.,
                1.}}]}],
           
           ImageSizeCache->{{220.25, 
            264.75}, {-136.72321439355403`, -92.22321439355402}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{2, 9, 17, 18, 11, 3}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{2, 9, 17, 18, 11, 3}], {{{0.5, 0.}, {0., 0.5}}, {1.,
                1.5}}]}],
           
           ImageSizeCache->{{220.25, 
            264.75}, {-180.7686689390086, -136.2686689390086}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{3, 10, 18, 19, 12, 4}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{3, 10, 18, 19, 12, 4}], {{{0.5, 0.}, {0., 0.5}}, {
               1., 2.}}]}],
           
           ImageSizeCache->{{220.25, 
            264.75}, {-224.81412348446312`, -180.31412348446312`}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{4, 11, 19, 20, 13, 5}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{4, 11, 19, 20, 13, 5}], {{{0.5, 0.}, {0., 0.5}}, {
               1., 2.5}}]}],
           
           ImageSizeCache->{{220.25, 
            264.75}, {-268.85957802991766`, -224.35957802991766`}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{5, 12, 20, 21, 14, 6}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{5, 12, 20, 21, 14, 6}], {{{0.5, 0.}, {0., 0.5}}, {
               1., 3.}}]}],
           
           ImageSizeCache->{{220.25, 
            264.75}, {-312.9050325753723, -268.4050325753723}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{8, 15, 23, 24, 17, 9}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{8, 15, 23, 24, 17, 9}], {{{0.5, 0.}, {0., 0.5}}, {
               1.5, 1.}}]}],
           
           ImageSizeCache->{{264.29545454545456`, 
            308.79545454545456`}, {-136.72321439355403`, \
-92.22321439355402}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{9, 16, 24, 25, 18, 10}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{9, 16, 24, 25, 18, 10}], {{{0.5, 0.}, {0., 0.5}}, {
               1.5, 1.5}}]}],
           
           ImageSizeCache->{{264.29545454545456`, 
            308.79545454545456`}, {-180.7686689390086, -136.2686689390086}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{10, 17, 25, 26, 19, 11}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{10, 17, 25, 26, 19, 11}], {{{0.5, 0.}, {0., 0.5}}, {
               1.5, 2.}}]}],
           
           ImageSizeCache->{{264.29545454545456`, 
            308.79545454545456`}, {-224.81412348446312`, \
-180.31412348446312`}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{11, 18, 26, 27, 20, 12}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{11, 18, 26, 27, 20, 12}], {{{0.5, 0.}, {0., 0.5}}, {
               1.5, 2.5}}]}],
           
           ImageSizeCache->{{264.29545454545456`, 
            
            308.79545454545456`}, {-268.85957802991766`, \
-224.35957802991766`}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{12, 19, 27, 28, 21, 13}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{12, 19, 27, 28, 21, 13}], {{{0.5, 0.}, {0., 0.5}}, {
               1.5, 3.}}]}],
           
           ImageSizeCache->{{264.29545454545456`, 
            308.79545454545456`}, {-312.9050325753723, -268.4050325753723}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{15, 22, 30, 31, 24, 16}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{15, 22, 30, 31, 24, 16}], {{{0.5, 0.}, {0., 0.5}}, {
               2., 1.}}]}],
           
           ImageSizeCache->{{308.3409090909091, 
            352.8409090909091}, {-136.72321439355403`, -92.22321439355402}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{16, 23, 31, 32, 25, 17}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{16, 23, 31, 32, 25, 17}], {{{0.5, 0.}, {0., 0.5}}, {
               2., 1.5}}]}],
           
           ImageSizeCache->{{308.3409090909091, 
            352.8409090909091}, {-180.7686689390086, -136.2686689390086}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{17, 24, 32, 33, 26, 18}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{17, 24, 32, 33, 26, 18}], {{{0.5, 0.}, {0., 0.5}}, {
               2., 2.}}]}],
           
           ImageSizeCache->{{308.3409090909091, 
            352.8409090909091}, {-224.81412348446312`, \
-180.31412348446312`}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{18, 25, 33, 34, 27, 19}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{18, 25, 33, 34, 27, 19}], {{{0.5, 0.}, {0., 0.5}}, {
               2., 2.5}}]}],
           
           ImageSizeCache->{{308.3409090909091, 
            352.8409090909091}, {-268.85957802991766`, \
-224.35957802991766`}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{19, 26, 34, 35, 28, 20}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{19, 26, 34, 35, 28, 20}], {{{0.5, 0.}, {0., 0.5}}, {
               2., 3.}}]}],
           
           ImageSizeCache->{{308.3409090909091, 
            352.8409090909091}, {-312.9050325753723, -268.4050325753723}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{22, 29, 37, 38, 31, 23}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{22, 29, 37, 38, 31, 23}], {{{0.5, 0.}, {0., 0.5}}, {
               2.5, 1.}}]}],
           ImageSizeCache->{{352.3863636363636, 
            396.8863636363636}, {-136.72321439355403`, -92.22321439355402}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{23, 30, 38, 39, 32, 24}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{23, 30, 38, 39, 32, 24}], {{{0.5, 0.}, {0., 0.5}}, {
               2.5, 1.5}}]}],
           
           ImageSizeCache->{{352.3863636363636, 
            396.8863636363636}, {-180.7686689390086, -136.2686689390086}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{24, 31, 39, 40, 33, 25}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{24, 31, 39, 40, 33, 25}], {{{0.5, 0.}, {0., 0.5}}, {
               2.5, 2.}}]}],
           
           ImageSizeCache->{{352.3863636363636, 
            396.8863636363636}, {-224.81412348446312`, \
-180.31412348446312`}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{25, 32, 40, 41, 34, 26}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{25, 32, 40, 41, 34, 26}], {{{0.5, 0.}, {0., 0.5}}, {
               2.5, 2.5}}]}],
           
           ImageSizeCache->{{352.3863636363636, 
            396.8863636363636}, {-268.85957802991766`, \
-224.35957802991766`}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{26, 33, 41, 42, 35, 27}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{26, 33, 41, 42, 35, 27}], {{{0.5, 0.}, {0., 0.5}}, {
               2.5, 3.}}]}],
           
           ImageSizeCache->{{352.3863636363636, 
            396.8863636363636}, {-312.9050325753723, -268.4050325753723}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{29, 36, 44, 45, 38, 30}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{29, 36, 44, 45, 38, 30}], {{{0.5, 0.}, {0., 0.5}}, {
               3., 1.}}]}],
           
           ImageSizeCache->{{396.43181818181824`, 
            440.93181818181824`}, {-136.72321439355403`, \
-92.22321439355402}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{30, 37, 45, 46, 39, 31}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{30, 37, 45, 46, 39, 31}], {{{0.5, 0.}, {0., 0.5}}, {
               3., 1.5}}]}],
           
           ImageSizeCache->{{396.43181818181824`, 
            440.93181818181824`}, {-180.7686689390086, -136.2686689390086}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{31, 38, 46, 47, 40, 32}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{31, 38, 46, 47, 40, 32}], {{{0.5, 0.}, {0., 0.5}}, {
               3., 2.}}]}],
           
           ImageSizeCache->{{396.43181818181824`, 
            440.93181818181824`}, {-224.81412348446312`, \
-180.31412348446312`}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{32, 39, 47, 48, 41, 33}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{32, 39, 47, 48, 41, 33}], {{{0.5, 0.}, {0., 0.5}}, {
               3., 2.5}}]}],
           
           ImageSizeCache->{{396.43181818181824`, 
            440.93181818181824`}, {-268.85957802991766`, \
-224.35957802991766`}}], 
          DynamicBox[If[
            CurrentValue["MouseOver"], {
             FaceForm[{
               RGBColor[0.85, 0.7, 0.85], 
               Opacity[0.5]}], 
             PolygonBox[{33, 40, 48, 49, 42, 34}]}, {
             FaceForm[{
               Opacity[0.01]}], 
             GeometricTransformationBox[
              
              PolygonBox[{33, 40, 48, 49, 42, 34}], {{{0.5, 0.}, {0., 0.5}}, {
               3., 3.}}]}],
           
           ImageSizeCache->{{396.43181818181824`, 
            440.93181818181824`}, {-312.9050325753723, \
-268.4050325753723}}]}}}}], 
     NCache[{{1, Rational[-1, 2]}, {0, Rational[1, 2] 3^Rational[1, 2]}}, {{
       1, -0.5}, {0, 0.8660254037844386}}]],
    Background->None,
    ImageMargins->0.,
    ImageSize->{486., Automatic},
    PlotRangePadding->1], {0., -0.010086245900879476`}, 
   ImageScaled[{0., 0.}], {486., 357.},
   ContentSelectable->True],
  AspectRatio->0.6774193548387096,
  Background->None,
  ContentSelectable->True,
  ImageMargins->0.,
  ImagePadding->0.,
  ImageSize->{527., 357.},
  PlotRange->{{0., 526.9999999999999}, {0., 357.}},
  PlotRangePadding->None]], "Input",
 CellChangeTimes->{{3.606279576708064*^9, 3.6062795768466473`*^9}}],

Cell[TextData[{
 "So to take advantage of all the power of ",
 StyleBox["CellularAutomaton", "Input"],
 ", all we have to do, is to use a following special 6-neighborhood stencil \
on rectangle lattices, meanwhile our model can be discussed and constructed \
on regular triangular lattice convieniently:"
}], "Text",
 CellChangeTimes->{{3.6062047216508427`*^9, 3.6062047380277786`*^9}, {
  3.606204801442381*^9, 3.606204851100196*^9}, {3.6062049579642687`*^9, 
  3.606205008987167*^9}, {3.6062050510345545`*^9, 3.606205059873057*^9}, {
  3.6062050986072583`*^9, 3.606205231830827*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SparseArray", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i_", ",", "i_"}], "}"}], "/;", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "1"}], "||", 
         RowBox[{"i", "\[Equal]", "3"}]}]}], "\[RuleDelayed]", 
       RowBox[{"Item", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "i"}], "}"}], ",", 
         RowBox[{"Background", "\[Rule]", 
          RowBox[{"GrayLevel", "[", ".8", "]"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}], "\[RuleDelayed]", 
       RowBox[{"Item", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}], ",", 
         RowBox[{"Background", "\[Rule]", 
          RowBox[{"Lighter", "[", 
           RowBox[{"Green", ",", ".8"}], "]"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "3"}], "}"}]}], "]"}], "//", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{"#", ",", 
     RowBox[{"ItemStyle", "\[Rule]", 
      RowBox[{"{", "16", "}"}]}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.6062058603505383`*^9, 3.6062060976020117`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     ItemBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}],
      Background->GrayLevel[0.8],
      StripOnInput->False], 
     ItemBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}],
      Background->RGBColor[0.8, 1., 0.8],
      StripOnInput->False], 
     ItemBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}],
      Background->RGBColor[0.8, 1., 0.8],
      StripOnInput->False]},
    {
     ItemBox[
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}],
      Background->RGBColor[0.8, 1., 0.8],
      StripOnInput->False], 
     ItemBox[
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}],
      Background->RGBColor[0.8, 1., 0.8],
      StripOnInput->False], 
     ItemBox[
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}],
      Background->RGBColor[0.8, 1., 0.8],
      StripOnInput->False]},
    {
     ItemBox[
      RowBox[{"{", 
       RowBox[{"3", ",", "1"}], "}"}],
      Background->RGBColor[0.8, 1., 0.8],
      StripOnInput->False], 
     ItemBox[
      RowBox[{"{", 
       RowBox[{"3", ",", "2"}], "}"}],
      Background->RGBColor[0.8, 1., 0.8],
      StripOnInput->False], 
     ItemBox[
      RowBox[{"{", 
       RowBox[{"3", ",", "3"}], "}"}],
      Background->GrayLevel[0.8],
      StripOnInput->False]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
   GridBoxItemStyle->{"Columns" -> {{16}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.606205954151862*^9, 3.6062060209826584`*^9}, {
  3.6062060577927494`*^9, 3.606206100167163*^9}}]
}, {2}]],

Cell["\<\
And after the calculation, we can perform the affine transformation with \
following functions to get a nice hexagonal grid picture.\
\>", "Text",
 CellChangeTimes->{{3.6062108947125397`*^9, 3.6062109830165567`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "vertexFunc", "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"vertexFunc", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"para", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"center", ",", "ratio"}], "}"}], ",", 
        RowBox[{
         RowBox[{"center", "=", 
          RowBox[{"para", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ratio", "=", 
          RowBox[{"para", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Re", "[", "#", "]"}], ",", 
              RowBox[{"Im", "[", "#", "]"}]}], "}"}], "+", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{
                  RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], "}"}]}], 
              "}"}], ".", 
             RowBox[{"Reverse", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}], " ", "center"}], "+", 
               RowBox[{"{", 
                RowBox[{"3", ",", "0"}], "}"}]}], "]"}]}]}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"ratio", " ", 
            RowBox[{"1", "/", 
             RowBox[{"Sqrt", "[", "3", "]"}]}], " ", 
            RowBox[{"E", "^", 
             RowBox[{"(", 
              RowBox[{"I", " ", 
               RowBox[{"\[Pi]", "/", "6"}]}], ")"}]}], " ", 
            RowBox[{"E", "^", 
             RowBox[{"(", 
              RowBox[{"I", " ", 
               RowBox[{"Range", "[", "6", "]"}], " ", 
               RowBox[{"\[Pi]", "/", "3"}]}], ")"}]}]}], ")"}]}]}]}], "]"}], 
      ",", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}], ",", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{",", 
       RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], "*)"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{"Clear", "[", "displayfunc", "]"}], "\n", 
 RowBox[{
  RowBox[{"displayfunc", "[", 
   RowBox[{"array_", ",", "ratio_"}], "]"}], ":=", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FaceForm", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ColorData", "[", "\"\<DeepSeaColors\>\"", "]"}], "[", "3", 
         "]"}], "}"}], "]"}], ",", 
      RowBox[{"EdgeForm", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ColorData", "[", "\"\<DeepSeaColors\>\"", "]"}], "[", "4", 
         "]"}], "}"}], "]"}], ",", 
      RowBox[{"Polygon", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vertexFunc", "[", 
          RowBox[{"Append", "[", 
           RowBox[{"#", ",", "ratio"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"Position", "[", 
         RowBox[{"array", ",", "1"}], "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"Background", "\[Rule]", 
     RowBox[{
      RowBox[{"ColorData", "[", "\"\<DeepSeaColors\>\"", "]"}], "[", "0", 
      "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.606210975342121*^9, 3.606210975346122*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The model", "Subsubsection",
 CellChangeTimes->{{3.606205362874271*^9, 3.6062053649423895`*^9}, {
  3.6062173423238354`*^9, 3.6062173430698776`*^9}}],

Cell["\<\
To construct the crystallization model, let\[CloseCurlyQuote]s consider one \
of the 6-neighborhood stencil, where each cell represents a minimal crystal \
unit:\
\>", "Text",
 CellChangeTimes->{{3.606205394636075*^9, 3.6062053989663267`*^9}, {
  3.606205476499728*^9, 3.6062055127647867`*^9}, {3.606206197997715*^9, 
  3.606206245825432*^9}, {3.6062062797813616`*^9, 3.6062062843936234`*^9}, {
  3.6062085250429173`*^9, 3.606208537903653*^9}, {3.606208568938416*^9, 
  3.606208570757514*^9}}],

Cell[BoxData[
 GraphicsBox[{{
    {EdgeForm[RGBColor[0.5147073333333334, 0.6164133333333334, 0.665802]], 
     FaceForm[RGBColor[0.772061, 0.92462, 0.998703]], PolygonBox[{}]}, 
    {EdgeForm[GrayLevel[0.7]], FaceForm[GrayLevel[0.3]], 
     PolygonBox[CompressedData["
1:eJxVkD0KwkAQhTeJiK2Nij+gjYXY2QqzjRewthKsBTtvkSPYeQUFIXfwACZE
+4gICYJGszsvMgtbPN7u92beYLmerzylVJWv+7uOKs6duhN/tt+62kgV0XF8
WWxGSn/y4oR0pWej3krpbXTC7x9kZJ5SxL7lZXTg/5antORnJR8afJuXl3zr
VzT40OA7PO9N+P60J/7vTpYX04v3aRt95ryEmuzLPv75kq+05GO/mPvwNPjW
rmnwocFHXk/4EfXFfCF1rA7QP78P0P+QffQv8zEv+FnJhwYf/YOP/cGHBv8L
vnDdOg==
      "]], 
     {EdgeForm[None], FaceForm[RGBColor[0.85, 0.7, 0.85]], 
      PolygonBox[{{1.5000000000000002`, 1.4433756729740645`}, {1., 
       1.1547005383792517`}, {0.9999999999999999, 0.5773502691896257}, {
       1.4999999999999996`, 0.28867513459481275`}, {1.9999999999999998`, 
       0.5773502691896252}, {2., 1.1547005383792515`}}]}}}, {InsetBox[
     StyleBox[
      TemplateBox[{"1","1"},
       "Row",
       DisplayFunction->(RowBox[{#, ",", #2}]& ),
       InterpretationFunction->(RowBox[{"Row", "[", 
          RowBox[{
            RowBox[{"{", 
              RowBox[{#, ",", #2}], "}"}], ",", "\",\""}], "]"}]& )],
      StripOnInput->False,
      LineColor->GrayLevel[1],
      FrontFaceColor->GrayLevel[1],
      BackFaceColor->GrayLevel[1],
      GraphicsColor->GrayLevel[1],
      FontSize->20,
      FontColor->GrayLevel[1]], 
     NCache[{0, 3^Rational[1, 2]}, {0, 1.7320508075688772`}]], InsetBox[
     StyleBox[
      TemplateBox[{"1","2"},
       "Row",
       DisplayFunction->(RowBox[{#, ",", #2}]& ),
       InterpretationFunction->(RowBox[{"Row", "[", 
          RowBox[{
            RowBox[{"{", 
              RowBox[{#, ",", #2}], "}"}], ",", "\",\""}], "]"}]& )],
      StripOnInput->False,
      LineColor->GrayLevel[1],
      FrontFaceColor->GrayLevel[1],
      BackFaceColor->GrayLevel[1],
      GraphicsColor->GrayLevel[1],
      FontSize->20,
      FontColor->GrayLevel[1]], 
     NCache[{1, 3^Rational[1, 2]}, {1, 1.7320508075688772`}]], InsetBox[
     StyleBox[
      TemplateBox[{"1","3"},
       "Row",
       DisplayFunction->(RowBox[{#, ",", #2}]& ),
       InterpretationFunction->(RowBox[{"Row", "[", 
          RowBox[{
            RowBox[{"{", 
              RowBox[{#, ",", #2}], "}"}], ",", "\",\""}], "]"}]& )],
      StripOnInput->False,
      LineColor->GrayLevel[1],
      FrontFaceColor->GrayLevel[1],
      BackFaceColor->GrayLevel[1],
      GraphicsColor->GrayLevel[1],
      FontSize->20,
      FontColor->GrayLevel[1]], 
     NCache[{2, 3^Rational[1, 2]}, {2, 1.7320508075688772`}]], InsetBox[
     StyleBox[
      TemplateBox[{"2","1"},
       "Row",
       DisplayFunction->(RowBox[{#, ",", #2}]& ),
       InterpretationFunction->(RowBox[{"Row", "[", 
          RowBox[{
            RowBox[{"{", 
              RowBox[{#, ",", #2}], "}"}], ",", "\",\""}], "]"}]& )],
      StripOnInput->False,
      LineColor->GrayLevel[1],
      FrontFaceColor->GrayLevel[1],
      BackFaceColor->GrayLevel[1],
      GraphicsColor->GrayLevel[1],
      FontSize->20,
      FontColor->GrayLevel[1]], 
     NCache[{Rational[1, 2], Rational[1, 2] 3^Rational[1, 2]}, {0.5, 
      0.8660254037844386}]], InsetBox[
     StyleBox[
      TemplateBox[{"2","2"},
       "Row",
       DisplayFunction->(RowBox[{#, ",", #2}]& ),
       InterpretationFunction->(RowBox[{"Row", "[", 
          RowBox[{
            RowBox[{"{", 
              RowBox[{#, ",", #2}], "}"}], ",", "\",\""}], "]"}]& )],
      StripOnInput->False,
      LineColor->GrayLevel[1],
      FrontFaceColor->GrayLevel[1],
      BackFaceColor->GrayLevel[1],
      GraphicsColor->GrayLevel[1],
      FontSize->20,
      FontColor->GrayLevel[1]], 
     NCache[{Rational[3, 2], Rational[1, 2] 3^Rational[1, 2]}, {1.5, 
      0.8660254037844386}]], InsetBox[
     StyleBox[
      TemplateBox[{"2","3"},
       "Row",
       DisplayFunction->(RowBox[{#, ",", #2}]& ),
       InterpretationFunction->(RowBox[{"Row", "[", 
          RowBox[{
            RowBox[{"{", 
              RowBox[{#, ",", #2}], "}"}], ",", "\",\""}], "]"}]& )],
      StripOnInput->False,
      LineColor->GrayLevel[1],
      FrontFaceColor->GrayLevel[1],
      BackFaceColor->GrayLevel[1],
      GraphicsColor->GrayLevel[1],
      FontSize->20,
      FontColor->GrayLevel[1]], 
     NCache[{Rational[5, 2], Rational[1, 2] 3^Rational[1, 2]}, {2.5, 
      0.8660254037844386}]], InsetBox[
     StyleBox[
      TemplateBox[{"3","1"},
       "Row",
       DisplayFunction->(RowBox[{#, ",", #2}]& ),
       InterpretationFunction->(RowBox[{"Row", "[", 
          RowBox[{
            RowBox[{"{", 
              RowBox[{#, ",", #2}], "}"}], ",", "\",\""}], "]"}]& )],
      StripOnInput->False,
      LineColor->GrayLevel[1],
      FrontFaceColor->GrayLevel[1],
      BackFaceColor->GrayLevel[1],
      GraphicsColor->GrayLevel[1],
      FontSize->20,
      FontColor->GrayLevel[1]], {1, 0}], InsetBox[
     StyleBox[
      TemplateBox[{"3","2"},
       "Row",
       DisplayFunction->(RowBox[{#, ",", #2}]& ),
       InterpretationFunction->(RowBox[{"Row", "[", 
          RowBox[{
            RowBox[{"{", 
              RowBox[{#, ",", #2}], "}"}], ",", "\",\""}], "]"}]& )],
      StripOnInput->False,
      LineColor->GrayLevel[1],
      FrontFaceColor->GrayLevel[1],
      BackFaceColor->GrayLevel[1],
      GraphicsColor->GrayLevel[1],
      FontSize->20,
      FontColor->GrayLevel[1]], {2, 0}], InsetBox[
     StyleBox[
      TemplateBox[{"3","3"},
       "Row",
       DisplayFunction->(RowBox[{#, ",", #2}]& ),
       InterpretationFunction->(RowBox[{"Row", "[", 
          RowBox[{
            RowBox[{"{", 
              RowBox[{#, ",", #2}], "}"}], ",", "\",\""}], "]"}]& )],
      StripOnInput->False,
      LineColor->GrayLevel[1],
      FrontFaceColor->GrayLevel[1],
      BackFaceColor->GrayLevel[1],
      GraphicsColor->GrayLevel[1],
      FontSize->20,
      FontColor->GrayLevel[1]], {3, 0}]}},
  Background->GrayLevel[1],
  ImageSize->{261., Automatic}]], "Output",
 CellChangeTimes->{
  3.5534196565380516`*^9, 3.55341970055857*^9, 3.55341974235096*^9, {
   3.5534197837783294`*^9, 3.553419788176581*^9}, {3.553419870753304*^9, 
   3.553419922499264*^9}, 3.553419954639102*^9, 3.553420136375497*^9, {
   3.553420178187888*^9, 3.553420203347327*^9}, {3.553421263117943*^9, 
   3.553421346160692*^9}, 3.5534591802466784`*^9, 3.5538366266478453`*^9}],

Cell[TextData[{
 "A simple model will need only 2 states: 0 for \[OpenCurlyDoubleQuote]It\
\[CloseCurlyQuote]s empty\[CloseCurlyDoubleQuote], 1 for \
\[OpenCurlyDoubleQuote]There is a crystal unit\[CloseCurlyDoubleQuote]. So by \
considering all (except the ",
 Cell[BoxData[
  FormBox["000000", TraditionalForm]],
  FormatType->"TraditionalForm"],
 " one, because we are generating ONE snowflake thus don\[CloseCurlyQuote]t \
want a crystall randomly ",
 "arises from void",
 ") 6-bit non-negative numbers, we can have a finite set of possible \
arrangements of the neighborhood:"
}], "Text",
 CellChangeTimes->{{3.6062061616166534`*^9, 3.6062061807767363`*^9}, {
  3.606206211241468*^9, 3.6062062150156813`*^9}, {3.6062063601299257`*^9, 
  3.6062065363069353`*^9}, {3.60620657459711*^9, 3.6062066021076727`*^9}, {
  3.6062066434990253`*^9, 3.6062067266847553`*^9}, {3.606206763014814*^9, 
  3.606206915319467*^9}, {3.6062069471092777`*^9, 3.6062069847104144`*^9}, {
  3.606207280395212*^9, 3.6062073711903653`*^9}, {3.606207658096665*^9, 
  3.606207667027172*^9}, {3.6062087256993165`*^9, 3.606208888912589*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stateSet", "=", 
   RowBox[{
    RowBox[{"Tuples", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", "6"}], "]"}], "//", "Rest"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.606207672086466*^9, 3.606207683005086*^9}, 
   3.6062796237057447`*^9}],

Cell[TextData[{
 "However, from the viewpoint of physics, any two arrangements which can be \
transformed into each other with only rotation and reflection should be \
considered as the same arrangement in the sense of their physical effects on \
the central cell (i.e. ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["cell", 
    RowBox[{"2", ",", "2"}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ") are the same:"
}], "Text",
 CellChangeTimes->{{3.6062061616166534`*^9, 3.6062061807767363`*^9}, {
   3.606206211241468*^9, 3.6062062150156813`*^9}, {3.6062063601299257`*^9, 
   3.6062065363069353`*^9}, {3.60620657459711*^9, 3.6062066021076727`*^9}, {
   3.6062066434990253`*^9, 3.6062067266847553`*^9}, {3.606206763014814*^9, 
   3.606206915319467*^9}, {3.6062069471092777`*^9, 3.6062069847104144`*^9}, {
   3.606207280395212*^9, 3.6062073711903653`*^9}, 3.606207658096665*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    GraphicsBox[{
      {EdgeForm[RGBColor[0.5147073333333334, 0.6164133333333334, 0.665802]], 
       FaceForm[RGBColor[0.772061, 0.92462, 0.998703]], 
       PolygonBox[
        NCache[{{{
           Rational[1, 2], 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           0, Rational[1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           0, Rational[-1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           Rational[1, 2], -3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           1, Rational[-1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           1, Rational[1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}}, {{
           Rational[5, 2], 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           2, Rational[1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           2, Rational[-1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           Rational[5, 2], -3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           3, Rational[-1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           3, Rational[1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}}, {{1, 3^Rational[-1, 2]}, {
           Rational[1, 2], Rational[1, 2] 3^Rational[-1, 2]}, {
           Rational[1, 2], Rational[-1, 2] 3^Rational[-1, 2]}, {
           1, -3^Rational[-1, 2]}, {
           Rational[3, 2], Rational[-1, 2] 3^Rational[-1, 2]}, {
           Rational[3, 2], Rational[1, 2] 3^Rational[-1, 2]}}}, {{{0.5, 
           1.4433756729740645`}, {0, 1.1547005383792515`}, {
           0, 0.5773502691896257}, {0.5, 0.28867513459481275`}, {
           1, 0.5773502691896257}, {1, 1.1547005383792515`}}, {{2.5, 
           1.4433756729740645`}, {2, 1.1547005383792515`}, {
           2, 0.5773502691896257}, {2.5, 0.28867513459481275`}, {
           3, 0.5773502691896257}, {3, 1.1547005383792515`}}, {{
           1, 0.5773502691896258}, {0.5, 0.2886751345948129}, {
           0.5, -0.2886751345948129}, {1, -0.5773502691896258}, {
           1.5, -0.2886751345948129}, {1.5, 0.2886751345948129}}}]]}, 
      {EdgeForm[GrayLevel[0.7]], FaceForm[GrayLevel[0.3]], 
       PolygonBox[
        NCache[{{{1, 3^Rational[-1, 2] + 3^Rational[1, 2]}, {
           Rational[1, 2], Rational[1, 2] 3^Rational[-1, 2] + 
            3^Rational[1, 2]}, {
           Rational[1, 2], Rational[-1, 2] 3^Rational[-1, 2] + 
            3^Rational[1, 2]}, {1, -3^Rational[-1, 2] + 3^Rational[1, 2]}, {
           Rational[3, 2], Rational[-1, 2] 3^Rational[-1, 2] + 
            3^Rational[1, 2]}, {
           Rational[3, 2], Rational[1, 2] 3^Rational[-1, 2] + 
            3^Rational[1, 2]}}, {{2, 3^Rational[-1, 2] + 3^Rational[1, 2]}, {
           Rational[3, 2], Rational[1, 2] 3^Rational[-1, 2] + 
            3^Rational[1, 2]}, {
           Rational[3, 2], Rational[-1, 2] 3^Rational[-1, 2] + 
            3^Rational[1, 2]}, {2, -3^Rational[-1, 2] + 3^Rational[1, 2]}, {
           Rational[5, 2], Rational[-1, 2] 3^Rational[-1, 2] + 
            3^Rational[1, 2]}, {
           Rational[5, 2], Rational[1, 2] 3^Rational[-1, 2] + 
            3^Rational[1, 2]}}, {{2, 3^Rational[-1, 2]}, {
           Rational[3, 2], Rational[1, 2] 3^Rational[-1, 2]}, {
           Rational[3, 2], Rational[-1, 2] 3^Rational[-1, 2]}, {
           2, -3^Rational[-1, 2]}, {
           Rational[5, 2], Rational[-1, 2] 3^Rational[-1, 2]}, {
           Rational[5, 2], Rational[1, 2] 3^Rational[-1, 2]}}}, {{{
           1, 2.309401076758503}, {0.5, 2.0207259421636903`}, {0.5, 
           1.4433756729740643`}, {1, 1.1547005383792515`}, {1.5, 
           1.4433756729740643`}, {1.5, 2.0207259421636903`}}, {{
           2, 2.309401076758503}, {1.5, 2.0207259421636903`}, {1.5, 
           1.4433756729740643`}, {2, 1.1547005383792515`}, {2.5, 
           1.4433756729740643`}, {2.5, 2.0207259421636903`}}, {{
           2, 0.5773502691896258}, {1.5, 0.2886751345948129}, {
           1.5, -0.2886751345948129}, {2, -0.5773502691896258}, {
           2.5, -0.2886751345948129}, {2.5, 0.2886751345948129}}}]], 
       {EdgeForm[None], FaceForm[RGBColor[0.85, 0.7, 0.85]], 
        PolygonBox[
         NCache[{{
           Rational[3, 2], 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           1, Rational[1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           1, Rational[-1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           Rational[3, 2], -3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           2, Rational[-1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           2, Rational[1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}}, {{1.5, 1.4433756729740645`}, {
           1, 1.1547005383792515`}, {1, 0.5773502691896257}, {1.5, 
           0.28867513459481275`}, {2, 0.5773502691896257}, {
           2, 1.1547005383792515`}}]]}}},
     Background->GrayLevel[1],
     ImageSize->120], ",", 
    TagBox[
     StyleBox[
      "\"\<\\!\\(\\*OverscriptBox[StyleBox[\\\"\\[DoubleLongLeftRightArrow]\\\
\",FontSize->20],  StyleBox[RowBox[{\\\"Equivalence\\\", \\\" \\\", \\\"Class\
\\\"}],FontSize->16]]\\)\>\"",
      ShowSpecialCharacters->False,
      ShowStringCharacters->True,
      NumberMarks->True],
     FullForm], ",", 
    GraphicsBox[{
      {EdgeForm[RGBColor[0.5147073333333334, 0.6164133333333334, 0.665802]], 
       FaceForm[RGBColor[0.772061, 0.92462, 0.998703]], 
       PolygonBox[
        NCache[{{{
           Rational[1, 2], 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           0, Rational[1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           0, Rational[-1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           Rational[1, 2], -3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           1, Rational[-1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           1, Rational[1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}}, {{
           Rational[5, 2], 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           2, Rational[1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           2, Rational[-1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           Rational[5, 2], -3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           3, Rational[-1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           3, Rational[1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}}, {{2, 3^Rational[-1, 2]}, {
           Rational[3, 2], Rational[1, 2] 3^Rational[-1, 2]}, {
           Rational[3, 2], Rational[-1, 2] 3^Rational[-1, 2]}, {
           2, -3^Rational[-1, 2]}, {
           Rational[5, 2], Rational[-1, 2] 3^Rational[-1, 2]}, {
           Rational[5, 2], Rational[1, 2] 3^Rational[-1, 2]}}}, {{{0.5, 
           1.4433756729740645`}, {0, 1.1547005383792515`}, {
           0, 0.5773502691896257}, {0.5, 0.28867513459481275`}, {
           1, 0.5773502691896257}, {1, 1.1547005383792515`}}, {{2.5, 
           1.4433756729740645`}, {2, 1.1547005383792515`}, {
           2, 0.5773502691896257}, {2.5, 0.28867513459481275`}, {
           3, 0.5773502691896257}, {3, 1.1547005383792515`}}, {{
           2, 0.5773502691896258}, {1.5, 0.2886751345948129}, {
           1.5, -0.2886751345948129}, {2, -0.5773502691896258}, {
           2.5, -0.2886751345948129}, {2.5, 0.2886751345948129}}}]]}, 
      {EdgeForm[GrayLevel[0.7]], FaceForm[GrayLevel[0.3]], 
       PolygonBox[
        NCache[{{{1, 3^Rational[-1, 2] + 3^Rational[1, 2]}, {
           Rational[1, 2], Rational[1, 2] 3^Rational[-1, 2] + 
            3^Rational[1, 2]}, {
           Rational[1, 2], Rational[-1, 2] 3^Rational[-1, 2] + 
            3^Rational[1, 2]}, {1, -3^Rational[-1, 2] + 3^Rational[1, 2]}, {
           Rational[3, 2], Rational[-1, 2] 3^Rational[-1, 2] + 
            3^Rational[1, 2]}, {
           Rational[3, 2], Rational[1, 2] 3^Rational[-1, 2] + 
            3^Rational[1, 2]}}, {{2, 3^Rational[-1, 2] + 3^Rational[1, 2]}, {
           Rational[3, 2], Rational[1, 2] 3^Rational[-1, 2] + 
            3^Rational[1, 2]}, {
           Rational[3, 2], Rational[-1, 2] 3^Rational[-1, 2] + 
            3^Rational[1, 2]}, {2, -3^Rational[-1, 2] + 3^Rational[1, 2]}, {
           Rational[5, 2], Rational[-1, 2] 3^Rational[-1, 2] + 
            3^Rational[1, 2]}, {
           Rational[5, 2], Rational[1, 2] 3^Rational[-1, 2] + 
            3^Rational[1, 2]}}, {{1, 3^Rational[-1, 2]}, {
           Rational[1, 2], Rational[1, 2] 3^Rational[-1, 2]}, {
           Rational[1, 2], Rational[-1, 2] 3^Rational[-1, 2]}, {
           1, -3^Rational[-1, 2]}, {
           Rational[3, 2], Rational[-1, 2] 3^Rational[-1, 2]}, {
           Rational[3, 2], Rational[1, 2] 3^Rational[-1, 2]}}}, {{{
           1, 2.309401076758503}, {0.5, 2.0207259421636903`}, {0.5, 
           1.4433756729740643`}, {1, 1.1547005383792515`}, {1.5, 
           1.4433756729740643`}, {1.5, 2.0207259421636903`}}, {{
           2, 2.309401076758503}, {1.5, 2.0207259421636903`}, {1.5, 
           1.4433756729740643`}, {2, 1.1547005383792515`}, {2.5, 
           1.4433756729740643`}, {2.5, 2.0207259421636903`}}, {{
           1, 0.5773502691896258}, {0.5, 0.2886751345948129}, {
           0.5, -0.2886751345948129}, {1, -0.5773502691896258}, {
           1.5, -0.2886751345948129}, {1.5, 0.2886751345948129}}}]], 
       {EdgeForm[None], FaceForm[RGBColor[0.85, 0.7, 0.85]], 
        PolygonBox[
         NCache[{{
           Rational[3, 2], 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           1, Rational[1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           1, Rational[-1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           Rational[3, 2], -3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           2, Rational[-1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}, {
           2, Rational[1, 2] 3^Rational[-1, 2] + 
            Rational[1, 2] 3^Rational[1, 2]}}, {{1.5, 1.4433756729740645`}, {
           1, 1.1547005383792515`}, {1, 0.5773502691896257}, {1.5, 
           0.28867513459481275`}, {2, 0.5773502691896257}, {
           2, 1.1547005383792515`}}]]}}},
     Background->GrayLevel[1],
     ImageSize->120]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.606207018289317*^9, 3.6062070893433533`*^9}, {
  3.6062071619474835`*^9, 3.6062071994526095`*^9}}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{
      EdgeForm[
       RGBColor[0.5147073333333334, 0.6164133333333334, 0.665802]], 
      FaceForm[
       RGBColor[0.772061, 0.92462, 0.998703]], 
      PolygonBox[
       NCache[{{{
           Rational[1, 2], 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          0, Rational[1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          0, Rational[-1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
           Rational[1, 2], -3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          1, Rational[-1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          1, Rational[1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}}, {{
           Rational[5, 2], 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          2, Rational[1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          2, Rational[-1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
           Rational[5, 2], -3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          3, Rational[-1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          3, Rational[1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}}, {{1, 3^Rational[-1, 2]}, {
           Rational[1, 2], Rational[1, 2] 3^Rational[-1, 2]}, {
           Rational[1, 2], Rational[-1, 2] 3^Rational[-1, 2]}, {
          1, -3^Rational[-1, 2]}, {
           Rational[3, 2], Rational[-1, 2] 3^Rational[-1, 2]}, {
           Rational[3, 2], Rational[1, 2] 3^Rational[-1, 2]}}}, {{{0.5, 
          1.4433756729740645`}, {0, 1.1547005383792515`}, {
          0, 0.5773502691896257}, {0.5, 0.28867513459481275`}, {
          1, 0.5773502691896257}, {1, 1.1547005383792515`}}, {{2.5, 
          1.4433756729740645`}, {2, 1.1547005383792515`}, {
          2, 0.5773502691896257}, {2.5, 0.28867513459481275`}, {
          3, 0.5773502691896257}, {3, 1.1547005383792515`}}, {{
          1, 0.5773502691896258}, {0.5, 0.2886751345948129}, {
          0.5, -0.2886751345948129}, {1, -0.5773502691896258}, {
          1.5, -0.2886751345948129}, {1.5, 0.2886751345948129}}}]]}, {
      EdgeForm[
       GrayLevel[0.7]], 
      FaceForm[
       GrayLevel[0.3]], 
      PolygonBox[
       NCache[{{{1, 3^Rational[-1, 2] + 3^Rational[1, 2]}, {
           Rational[1, 2], Rational[1, 2] 3^Rational[-1, 2] + 
           3^Rational[1, 2]}, {
           Rational[1, 2], Rational[-1, 2] 3^Rational[-1, 2] + 
           3^Rational[1, 2]}, {1, -3^Rational[-1, 2] + 3^Rational[1, 2]}, {
           Rational[3, 2], Rational[-1, 2] 3^Rational[-1, 2] + 
           3^Rational[1, 2]}, {
           Rational[3, 2], Rational[1, 2] 3^Rational[-1, 2] + 
           3^Rational[1, 2]}}, {{2, 3^Rational[-1, 2] + 3^Rational[1, 2]}, {
           Rational[3, 2], Rational[1, 2] 3^Rational[-1, 2] + 
           3^Rational[1, 2]}, {
           Rational[3, 2], Rational[-1, 2] 3^Rational[-1, 2] + 
           3^Rational[1, 2]}, {2, -3^Rational[-1, 2] + 3^Rational[1, 2]}, {
           Rational[5, 2], Rational[-1, 2] 3^Rational[-1, 2] + 
           3^Rational[1, 2]}, {
           Rational[5, 2], Rational[1, 2] 3^Rational[-1, 2] + 
           3^Rational[1, 2]}}, {{2, 3^Rational[-1, 2]}, {
           Rational[3, 2], Rational[1, 2] 3^Rational[-1, 2]}, {
           Rational[3, 2], Rational[-1, 2] 3^Rational[-1, 2]}, {
          2, -3^Rational[-1, 2]}, {
           Rational[5, 2], Rational[-1, 2] 3^Rational[-1, 2]}, {
           Rational[5, 2], Rational[1, 2] 3^Rational[-1, 2]}}}, {{{
          1, 2.309401076758503}, {0.5, 2.0207259421636903`}, {0.5, 
          1.4433756729740643`}, {1, 1.1547005383792515`}, {1.5, 
          1.4433756729740643`}, {1.5, 2.0207259421636903`}}, {{
          2, 2.309401076758503}, {1.5, 2.0207259421636903`}, {1.5, 
          1.4433756729740643`}, {2, 1.1547005383792515`}, {2.5, 
          1.4433756729740643`}, {2.5, 2.0207259421636903`}}, {{
          2, 0.5773502691896258}, {1.5, 0.2886751345948129}, {
          1.5, -0.2886751345948129}, {2, -0.5773502691896258}, {
          2.5, -0.2886751345948129}, {2.5, 0.2886751345948129}}}]], {
       EdgeForm[None], 
       FaceForm[
        RGBColor[0.85, 0.7, 0.85]], 
       PolygonBox[
        NCache[{{
           Rational[3, 2], 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          1, Rational[1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          1, Rational[-1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
           Rational[3, 2], -3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          2, Rational[-1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          2, Rational[1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}}, {{1.5, 1.4433756729740645`}, {
          1, 1.1547005383792515`}, {1, 0.5773502691896257}, {1.5, 
          0.28867513459481275`}, {2, 0.5773502691896257}, {
          2, 1.1547005383792515`}}]]}}}, Background -> GrayLevel[1], 
    ImageSize -> 120],
   "\"\\!\\(\\*OverscriptBox[StyleBox[\\\"\[DoubleLongLeftRightArrow]\\\",\
FontSize->20],  StyleBox[RowBox[{\\\"Equivalence\\\", \\\" \\\", \
\\\"Class\\\"}],FontSize->16]]\\)\"",GraphicsBox[{{
      EdgeForm[
       RGBColor[0.5147073333333334, 0.6164133333333334, 0.665802]], 
      FaceForm[
       RGBColor[0.772061, 0.92462, 0.998703]], 
      PolygonBox[
       NCache[{{{
           Rational[1, 2], 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          0, Rational[1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          0, Rational[-1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
           Rational[1, 2], -3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          1, Rational[-1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          1, Rational[1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}}, {{
           Rational[5, 2], 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          2, Rational[1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          2, Rational[-1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
           Rational[5, 2], -3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          3, Rational[-1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          3, Rational[1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}}, {{2, 3^Rational[-1, 2]}, {
           Rational[3, 2], Rational[1, 2] 3^Rational[-1, 2]}, {
           Rational[3, 2], Rational[-1, 2] 3^Rational[-1, 2]}, {
          2, -3^Rational[-1, 2]}, {
           Rational[5, 2], Rational[-1, 2] 3^Rational[-1, 2]}, {
           Rational[5, 2], Rational[1, 2] 3^Rational[-1, 2]}}}, {{{0.5, 
          1.4433756729740645`}, {0, 1.1547005383792515`}, {
          0, 0.5773502691896257}, {0.5, 0.28867513459481275`}, {
          1, 0.5773502691896257}, {1, 1.1547005383792515`}}, {{2.5, 
          1.4433756729740645`}, {2, 1.1547005383792515`}, {
          2, 0.5773502691896257}, {2.5, 0.28867513459481275`}, {
          3, 0.5773502691896257}, {3, 1.1547005383792515`}}, {{
          2, 0.5773502691896258}, {1.5, 0.2886751345948129}, {
          1.5, -0.2886751345948129}, {2, -0.5773502691896258}, {
          2.5, -0.2886751345948129}, {2.5, 0.2886751345948129}}}]]}, {
      EdgeForm[
       GrayLevel[0.7]], 
      FaceForm[
       GrayLevel[0.3]], 
      PolygonBox[
       NCache[{{{1, 3^Rational[-1, 2] + 3^Rational[1, 2]}, {
           Rational[1, 2], Rational[1, 2] 3^Rational[-1, 2] + 
           3^Rational[1, 2]}, {
           Rational[1, 2], Rational[-1, 2] 3^Rational[-1, 2] + 
           3^Rational[1, 2]}, {1, -3^Rational[-1, 2] + 3^Rational[1, 2]}, {
           Rational[3, 2], Rational[-1, 2] 3^Rational[-1, 2] + 
           3^Rational[1, 2]}, {
           Rational[3, 2], Rational[1, 2] 3^Rational[-1, 2] + 
           3^Rational[1, 2]}}, {{2, 3^Rational[-1, 2] + 3^Rational[1, 2]}, {
           Rational[3, 2], Rational[1, 2] 3^Rational[-1, 2] + 
           3^Rational[1, 2]}, {
           Rational[3, 2], Rational[-1, 2] 3^Rational[-1, 2] + 
           3^Rational[1, 2]}, {2, -3^Rational[-1, 2] + 3^Rational[1, 2]}, {
           Rational[5, 2], Rational[-1, 2] 3^Rational[-1, 2] + 
           3^Rational[1, 2]}, {
           Rational[5, 2], Rational[1, 2] 3^Rational[-1, 2] + 
           3^Rational[1, 2]}}, {{1, 3^Rational[-1, 2]}, {
           Rational[1, 2], Rational[1, 2] 3^Rational[-1, 2]}, {
           Rational[1, 2], Rational[-1, 2] 3^Rational[-1, 2]}, {
          1, -3^Rational[-1, 2]}, {
           Rational[3, 2], Rational[-1, 2] 3^Rational[-1, 2]}, {
           Rational[3, 2], Rational[1, 2] 3^Rational[-1, 2]}}}, {{{
          1, 2.309401076758503}, {0.5, 2.0207259421636903`}, {0.5, 
          1.4433756729740643`}, {1, 1.1547005383792515`}, {1.5, 
          1.4433756729740643`}, {1.5, 2.0207259421636903`}}, {{
          2, 2.309401076758503}, {1.5, 2.0207259421636903`}, {1.5, 
          1.4433756729740643`}, {2, 1.1547005383792515`}, {2.5, 
          1.4433756729740643`}, {2.5, 2.0207259421636903`}}, {{
          1, 0.5773502691896258}, {0.5, 0.2886751345948129}, {
          0.5, -0.2886751345948129}, {1, -0.5773502691896258}, {
          1.5, -0.2886751345948129}, {1.5, 0.2886751345948129}}}]], {
       EdgeForm[None], 
       FaceForm[
        RGBColor[0.85, 0.7, 0.85]], 
       PolygonBox[
        NCache[{{
           Rational[3, 2], 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          1, Rational[1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          1, Rational[-1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
           Rational[3, 2], -3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          2, Rational[-1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}, {
          2, Rational[1, 2] 3^Rational[-1, 2] + 
           Rational[1, 2] 3^Rational[1, 2]}}, {{1.5, 1.4433756729740645`}, {
          1, 1.1547005383792515`}, {1, 0.5773502691896257}, {1.5, 
          0.28867513459481275`}, {2, 0.5773502691896257}, {
          2, 1.1547005383792515`}}]]}}}, Background -> GrayLevel[1], 
    ImageSize -> 120]},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.6062070904214144`*^9, 3.606207211674309*^9}}]
}, {2}]],

Cell[TextData[{
 "So we should gather ",
 StyleBox["stateSet", "Input"],
 " with above equivalence class:"
}], "Text",
 CellChangeTimes->{{3.606207648716138*^9, 3.6062076505172396`*^9}, {
  3.606207716305972*^9, 3.6062077209372406`*^9}, {3.6062083350441236`*^9, 
  3.6062083669779425`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gatherTestFunc", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"lst", ",", 
     RowBox[{"Union", "[", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RotateLeft", "[", 
           RowBox[{"lst", ",", 
            RowBox[{"#", "-", "1"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"lst", ",", "1"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"RotateLeft", "[", 
           RowBox[{
            RowBox[{"Reverse", "[", "lst", "]"}], ",", 
            RowBox[{"#", "-", "1"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Reverse", "[", "lst", "]"}], ",", "1"}], "]"}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.606207769128973*^9, {3.6062078895138173`*^9, 3.606207899299367*^9}, {
   3.6062083733502994`*^9, 3.6062083738673286`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stateClsSet", "=", 
   RowBox[{"Sort", "/@", 
    RowBox[{"Gather", "[", 
     RowBox[{"stateSet", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"gatherTestFunc", "[", "#1", "]"}], "\[Equal]", 
        RowBox[{"gatherTestFunc", "[", "#2", "]"}]}], "&"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6062079044476604`*^9, 3.606207934846387*^9}, 
   3.606208103412964*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stateClsSetHomogeneous", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ArrayPad", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"12", "-", 
            RowBox[{"Length", "@", "#"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], "&"}], "/@", 
    "stateClsSet"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6062150631863556`*^9, 3.6062150633263626`*^9}}],

Cell["\<\
Which turned out to be 12 classes in total:\
\>", "Text",
 CellChangeTimes->{{3.606208433273703*^9, 3.606208467316638*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ArrayPlot", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Mesh", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"50", ",", "100"}], "}"}]}]}], "]"}], "&"}], "/@", 
   "stateClsSetHomogeneous"}], "//", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "@", "#"}], "]"}], ",", "#"}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{
  3.6062084170657816`*^9, {3.606215090002878*^9, 3.606215113152194*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"},
    {
     GraphicsBox[{
       RasterBox[{{1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 
        1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {0, 1,
         1, 1, 1, 1}, {1, 0, 1, 1, 1, 1}, {1, 1, 0, 1, 1, 1}, {1, 1, 1, 0, 1, 
        1}, {1, 1, 1, 1, 0, 1}, {1, 1, 1, 1, 1, 0}}, {{0, 0}, {6, 12}}, {0, 
        1}], {
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 12}, {6, 12}}, {{0, 11}, {6, 11}}, {{0, 10}, {6, 
           10}}, {{0, 9}, {6, 9}}, {{0, 8}, {6, 8}}, {{0, 7}, {6, 7}}, {{0, 
           6}, {6, 6}}, {{0, 5}, {6, 5}}, {{0, 4}, {6, 4}}, {{0, 3}, {6, 
           3}}, {{0, 2}, {6, 2}}, {{0, 1}, {6, 1}}, {{0, 0}, {6, 0}}}],
          Antialiasing->False]}, 
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 0}, {0, 12}}, {{1, 0}, {1, 12}}, {{2, 0}, {2, 12}}, {{
           3, 0}, {3, 12}}, {{4, 0}, {4, 12}}, {{5, 0}, {5, 12}}, {{6, 0}, {6,
            12}}}],
          Antialiasing->False]}}},
      Frame->False,
      FrameLabel->{None, None},
      FrameTicks->{{None, None}, {None, None}},
      ImageSize->{50, 100}], 
     GraphicsBox[{
       RasterBox[{{1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 
        1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {0, 0,
         1, 1, 1, 1}, {0, 1, 1, 1, 1, 0}, {1, 0, 0, 1, 1, 1}, {1, 1, 0, 0, 1, 
        1}, {1, 1, 1, 0, 0, 1}, {1, 1, 1, 1, 0, 0}}, {{0, 0}, {6, 12}}, {0, 
        1}], {
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 12}, {6, 12}}, {{0, 11}, {6, 11}}, {{0, 10}, {6, 
           10}}, {{0, 9}, {6, 9}}, {{0, 8}, {6, 8}}, {{0, 7}, {6, 7}}, {{0, 
           6}, {6, 6}}, {{0, 5}, {6, 5}}, {{0, 4}, {6, 4}}, {{0, 3}, {6, 
           3}}, {{0, 2}, {6, 2}}, {{0, 1}, {6, 1}}, {{0, 0}, {6, 0}}}],
          Antialiasing->False]}, 
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 0}, {0, 12}}, {{1, 0}, {1, 12}}, {{2, 0}, {2, 12}}, {{
           3, 0}, {3, 12}}, {{4, 0}, {4, 12}}, {{5, 0}, {5, 12}}, {{6, 0}, {6,
            12}}}],
          Antialiasing->False]}}},
      Frame->False,
      FrameLabel->{None, None},
      FrameTicks->{{None, None}, {None, None}},
      ImageSize->{50, 100}], 
     GraphicsBox[{
       RasterBox[{{1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 
        1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {0, 1,
         0, 1, 1, 1}, {0, 1, 1, 1, 0, 1}, {1, 0, 1, 0, 1, 1}, {1, 0, 1, 1, 1, 
        0}, {1, 1, 0, 1, 0, 1}, {1, 1, 1, 0, 1, 0}}, {{0, 0}, {6, 12}}, {0, 
        1}], {
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 12}, {6, 12}}, {{0, 11}, {6, 11}}, {{0, 10}, {6, 
           10}}, {{0, 9}, {6, 9}}, {{0, 8}, {6, 8}}, {{0, 7}, {6, 7}}, {{0, 
           6}, {6, 6}}, {{0, 5}, {6, 5}}, {{0, 4}, {6, 4}}, {{0, 3}, {6, 
           3}}, {{0, 2}, {6, 2}}, {{0, 1}, {6, 1}}, {{0, 0}, {6, 0}}}],
          Antialiasing->False]}, 
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 0}, {0, 12}}, {{1, 0}, {1, 12}}, {{2, 0}, {2, 12}}, {{
           3, 0}, {3, 12}}, {{4, 0}, {4, 12}}, {{5, 0}, {5, 12}}, {{6, 0}, {6,
            12}}}],
          Antialiasing->False]}}},
      Frame->False,
      FrameLabel->{None, None},
      FrameTicks->{{None, None}, {None, None}},
      ImageSize->{50, 100}], 
     GraphicsBox[{
       RasterBox[{{1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 
        1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {0, 0,
         0, 1, 1, 1}, {0, 0, 1, 1, 1, 0}, {0, 1, 1, 1, 0, 0}, {1, 0, 0, 0, 1, 
        1}, {1, 1, 0, 0, 0, 1}, {1, 1, 1, 0, 0, 0}}, {{0, 0}, {6, 12}}, {0, 
        1}], {
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 12}, {6, 12}}, {{0, 11}, {6, 11}}, {{0, 10}, {6, 
           10}}, {{0, 9}, {6, 9}}, {{0, 8}, {6, 8}}, {{0, 7}, {6, 7}}, {{0, 
           6}, {6, 6}}, {{0, 5}, {6, 5}}, {{0, 4}, {6, 4}}, {{0, 3}, {6, 
           3}}, {{0, 2}, {6, 2}}, {{0, 1}, {6, 1}}, {{0, 0}, {6, 0}}}],
          Antialiasing->False]}, 
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 0}, {0, 12}}, {{1, 0}, {1, 12}}, {{2, 0}, {2, 12}}, {{
           3, 0}, {3, 12}}, {{4, 0}, {4, 12}}, {{5, 0}, {5, 12}}, {{6, 0}, {6,
            12}}}],
          Antialiasing->False]}}},
      Frame->False,
      FrameLabel->{None, None},
      FrameTicks->{{None, None}, {None, None}},
      ImageSize->{50, 100}], 
     GraphicsBox[{
       RasterBox[{{1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 
        1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1,
         1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {0, 1, 1, 0, 1, 
        1}, {1, 0, 1, 1, 0, 1}, {1, 1, 0, 1, 1, 0}}, {{0, 0}, {6, 12}}, {0, 
        1}], {
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 12}, {6, 12}}, {{0, 11}, {6, 11}}, {{0, 10}, {6, 
           10}}, {{0, 9}, {6, 9}}, {{0, 8}, {6, 8}}, {{0, 7}, {6, 7}}, {{0, 
           6}, {6, 6}}, {{0, 5}, {6, 5}}, {{0, 4}, {6, 4}}, {{0, 3}, {6, 
           3}}, {{0, 2}, {6, 2}}, {{0, 1}, {6, 1}}, {{0, 0}, {6, 0}}}],
          Antialiasing->False]}, 
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 0}, {0, 12}}, {{1, 0}, {1, 12}}, {{2, 0}, {2, 12}}, {{
           3, 0}, {3, 12}}, {{4, 0}, {4, 12}}, {{5, 0}, {5, 12}}, {{6, 0}, {6,
            12}}}],
          Antialiasing->False]}}},
      Frame->False,
      FrameLabel->{None, None},
      FrameTicks->{{None, None}, {None, None}},
      ImageSize->{50, 100}], 
     GraphicsBox[{
       RasterBox[{{0, 0, 1, 0, 1, 1}, {0, 0, 1, 1, 0, 1}, {0, 1, 0, 0, 1, 
        1}, {0, 1, 0, 1, 1, 0}, {0, 1, 1, 0, 0, 1}, {0, 1, 1, 0, 1, 0}, {1, 0,
         0, 1, 0, 1}, {1, 0, 0, 1, 1, 0}, {1, 0, 1, 0, 0, 1}, {1, 0, 1, 1, 0, 
        0}, {1, 1, 0, 0, 1, 0}, {1, 1, 0, 1, 0, 0}}, {{0, 0}, {6, 12}}, {0, 
        1}], {
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 12}, {6, 12}}, {{0, 11}, {6, 11}}, {{0, 10}, {6, 
           10}}, {{0, 9}, {6, 9}}, {{0, 8}, {6, 8}}, {{0, 7}, {6, 7}}, {{0, 
           6}, {6, 6}}, {{0, 5}, {6, 5}}, {{0, 4}, {6, 4}}, {{0, 3}, {6, 
           3}}, {{0, 2}, {6, 2}}, {{0, 1}, {6, 1}}, {{0, 0}, {6, 0}}}],
          Antialiasing->False]}, 
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 0}, {0, 12}}, {{1, 0}, {1, 12}}, {{2, 0}, {2, 12}}, {{
           3, 0}, {3, 12}}, {{4, 0}, {4, 12}}, {{5, 0}, {5, 12}}, {{6, 0}, {6,
            12}}}],
          Antialiasing->False]}}},
      Frame->False,
      FrameLabel->{None, None},
      FrameTicks->{{None, None}, {None, None}},
      ImageSize->{50, 100}], 
     GraphicsBox[{
       RasterBox[{{1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 
        1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {0, 0,
         0, 0, 1, 1}, {0, 0, 0, 1, 1, 0}, {0, 0, 1, 1, 0, 0}, {0, 1, 1, 0, 0, 
        0}, {1, 0, 0, 0, 0, 1}, {1, 1, 0, 0, 0, 0}}, {{0, 0}, {6, 12}}, {0, 
        1}], {
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 12}, {6, 12}}, {{0, 11}, {6, 11}}, {{0, 10}, {6, 
           10}}, {{0, 9}, {6, 9}}, {{0, 8}, {6, 8}}, {{0, 7}, {6, 7}}, {{0, 
           6}, {6, 6}}, {{0, 5}, {6, 5}}, {{0, 4}, {6, 4}}, {{0, 3}, {6, 
           3}}, {{0, 2}, {6, 2}}, {{0, 1}, {6, 1}}, {{0, 0}, {6, 0}}}],
          Antialiasing->False]}, 
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 0}, {0, 12}}, {{1, 0}, {1, 12}}, {{2, 0}, {2, 12}}, {{
           3, 0}, {3, 12}}, {{4, 0}, {4, 12}}, {{5, 0}, {5, 12}}, {{6, 0}, {6,
            12}}}],
          Antialiasing->False]}}},
      Frame->False,
      FrameLabel->{None, None},
      FrameTicks->{{None, None}, {None, None}},
      ImageSize->{50, 100}], 
     GraphicsBox[{
       RasterBox[{{1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 
        1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1,
         1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 
        1}, {0, 1, 0, 1, 0, 1}, {1, 0, 1, 0, 1, 0}}, {{0, 0}, {6, 12}}, {0, 
        1}], {
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 12}, {6, 12}}, {{0, 11}, {6, 11}}, {{0, 10}, {6, 
           10}}, {{0, 9}, {6, 9}}, {{0, 8}, {6, 8}}, {{0, 7}, {6, 7}}, {{0, 
           6}, {6, 6}}, {{0, 5}, {6, 5}}, {{0, 4}, {6, 4}}, {{0, 3}, {6, 
           3}}, {{0, 2}, {6, 2}}, {{0, 1}, {6, 1}}, {{0, 0}, {6, 0}}}],
          Antialiasing->False]}, 
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 0}, {0, 12}}, {{1, 0}, {1, 12}}, {{2, 0}, {2, 12}}, {{
           3, 0}, {3, 12}}, {{4, 0}, {4, 12}}, {{5, 0}, {5, 12}}, {{6, 0}, {6,
            12}}}],
          Antialiasing->False]}}},
      Frame->False,
      FrameLabel->{None, None},
      FrameTicks->{{None, None}, {None, None}},
      ImageSize->{50, 100}], 
     GraphicsBox[{
       RasterBox[{{1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 
        1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {0, 0,
         0, 1, 0, 1}, {0, 0, 1, 0, 1, 0}, {0, 1, 0, 0, 0, 1}, {0, 1, 0, 1, 0, 
        0}, {1, 0, 0, 0, 1, 0}, {1, 0, 1, 0, 0, 0}}, {{0, 0}, {6, 12}}, {0, 
        1}], {
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 12}, {6, 12}}, {{0, 11}, {6, 11}}, {{0, 10}, {6, 
           10}}, {{0, 9}, {6, 9}}, {{0, 8}, {6, 8}}, {{0, 7}, {6, 7}}, {{0, 
           6}, {6, 6}}, {{0, 5}, {6, 5}}, {{0, 4}, {6, 4}}, {{0, 3}, {6, 
           3}}, {{0, 2}, {6, 2}}, {{0, 1}, {6, 1}}, {{0, 0}, {6, 0}}}],
          Antialiasing->False]}, 
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 0}, {0, 12}}, {{1, 0}, {1, 12}}, {{2, 0}, {2, 12}}, {{
           3, 0}, {3, 12}}, {{4, 0}, {4, 12}}, {{5, 0}, {5, 12}}, {{6, 0}, {6,
            12}}}],
          Antialiasing->False]}}},
      Frame->False,
      FrameLabel->{None, None},
      FrameTicks->{{None, None}, {None, None}},
      ImageSize->{50, 100}], 
     GraphicsBox[{
       RasterBox[{{1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 
        1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1,
         1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {0, 0, 1, 0, 0, 
        1}, {0, 1, 0, 0, 1, 0}, {1, 0, 0, 1, 0, 0}}, {{0, 0}, {6, 12}}, {0, 
        1}], {
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 12}, {6, 12}}, {{0, 11}, {6, 11}}, {{0, 10}, {6, 
           10}}, {{0, 9}, {6, 9}}, {{0, 8}, {6, 8}}, {{0, 7}, {6, 7}}, {{0, 
           6}, {6, 6}}, {{0, 5}, {6, 5}}, {{0, 4}, {6, 4}}, {{0, 3}, {6, 
           3}}, {{0, 2}, {6, 2}}, {{0, 1}, {6, 1}}, {{0, 0}, {6, 0}}}],
          Antialiasing->False]}, 
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 0}, {0, 12}}, {{1, 0}, {1, 12}}, {{2, 0}, {2, 12}}, {{
           3, 0}, {3, 12}}, {{4, 0}, {4, 12}}, {{5, 0}, {5, 12}}, {{6, 0}, {6,
            12}}}],
          Antialiasing->False]}}},
      Frame->False,
      FrameLabel->{None, None},
      FrameTicks->{{None, None}, {None, None}},
      ImageSize->{50, 100}], 
     GraphicsBox[{
       RasterBox[{{1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 
        1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {0, 0,
         0, 0, 0, 1}, {0, 0, 0, 0, 1, 0}, {0, 0, 0, 1, 0, 0}, {0, 0, 1, 0, 0, 
        0}, {0, 1, 0, 0, 0, 0}, {1, 0, 0, 0, 0, 0}}, {{0, 0}, {6, 12}}, {0, 
        1}], {
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 12}, {6, 12}}, {{0, 11}, {6, 11}}, {{0, 10}, {6, 
           10}}, {{0, 9}, {6, 9}}, {{0, 8}, {6, 8}}, {{0, 7}, {6, 7}}, {{0, 
           6}, {6, 6}}, {{0, 5}, {6, 5}}, {{0, 4}, {6, 4}}, {{0, 3}, {6, 
           3}}, {{0, 2}, {6, 2}}, {{0, 1}, {6, 1}}, {{0, 0}, {6, 0}}}],
          Antialiasing->False]}, 
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 0}, {0, 12}}, {{1, 0}, {1, 12}}, {{2, 0}, {2, 12}}, {{
           3, 0}, {3, 12}}, {{4, 0}, {4, 12}}, {{5, 0}, {5, 12}}, {{6, 0}, {6,
            12}}}],
          Antialiasing->False]}}},
      Frame->False,
      FrameLabel->{None, None},
      FrameTicks->{{None, None}, {None, None}},
      ImageSize->{50, 100}], 
     GraphicsBox[{
       RasterBox[{{1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 
        1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1,
         1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 
        1}, {1, 1, 1, 1, 1, 1}, {0, 0, 0, 0, 0, 0}}, {{0, 0}, {6, 12}}, {0, 
        1}], {
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 12}, {6, 12}}, {{0, 11}, {6, 11}}, {{0, 10}, {6, 
           10}}, {{0, 9}, {6, 9}}, {{0, 8}, {6, 8}}, {{0, 7}, {6, 7}}, {{0, 
           6}, {6, 6}}, {{0, 5}, {6, 5}}, {{0, 4}, {6, 4}}, {{0, 3}, {6, 
           3}}, {{0, 2}, {6, 2}}, {{0, 1}, {6, 1}}, {{0, 0}, {6, 0}}}],
          Antialiasing->False]}, 
        {GrayLevel[
          NCache[-1 + GoldenRatio, 0.6180339887498949]], 
         StyleBox[
          LineBox[{{{0, 0}, {0, 12}}, {{1, 0}, {1, 12}}, {{2, 0}, {2, 12}}, {{
           3, 0}, {3, 12}}, {{4, 0}, {4, 12}}, {{5, 0}, {5, 12}}, {{6, 0}, {6,
            12}}}],
          Antialiasing->False]}}},
      Frame->False,
      FrameLabel->{None, None},
      FrameTicks->{{None, None}, {None, None}},
      ImageSize->{50, 100}]}
   },
   AutoDelete->False,
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.6062084185568676`*^9, {3.606215067724613*^9, 3.6062151142332544`*^9}}]
}, {2}]],

Cell["\<\
Now from the viewpoint of cellular automaton, we need to establish a set of \
rules on how should any 6-neighborhood arrangement, i.e. those 12 kinds of \
equivalence classes, determine the state of the central cell.\
\>", "Text",
 CellChangeTimes->{{3.6062085758368025`*^9, 3.606208706123204*^9}, {
  3.606208921730453*^9, 3.606209009902462*^9}, {3.6062090446274357`*^9, 
  3.606209113032321*^9}, {3.6062092143800845`*^9, 3.6062092157031593`*^9}, {
  3.6062106331896834`*^9, 3.6062106353628063`*^9}}],

Cell[TextData[{
 "There are 4 kinds of possible transformations on ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["cell", 
    RowBox[{"2", ",", "2"}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ": ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0", "\[LongRightArrow]", "1"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " is called ",
 StyleBox["frozen",
  FontWeight->"Bold"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0", "\[LongRightArrow]", "0"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " is ",
 StyleBox["remaining empty",
  FontWeight->"Bold"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "\[LongRightArrow]", "1"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " is ",
 StyleBox["remaining frozen",
  FontWeight->"Bold"],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "\[LongRightArrow]", "0"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " is called ",
 StyleBox["melten",
  FontWeight->"Bold"],
 ". To make things more interesting and to explore more possibilities, we can \
introduce probability here, so certain arrangement will give certain ",
 StyleBox["probabilities",
  FontWeight->"Bold"],
 " corresponding to the 4 kinds of transformations. But notice that because \
of the unitarity of probability, we have ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"Prob", "(", "frozen", ")"}], "+", 
     RowBox[{"Prob", "(", 
      RowBox[{"0", "\[LongRightArrow]", "0"}], ")"}]}], "\[Congruent]", "1"}],
    TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"Prob", "(", "melten", ")"}], "+", 
     RowBox[{"Prob", "(", 
      RowBox[{"1", "\[LongRightArrow]", "1"}], ")"}]}], "\[Congruent]", "1"}],
    TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", so only 2 of the 4 probabilities are independent. In the following, we\
\[CloseCurlyQuote]ll choose ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Prob", "(", "frozen", ")"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Prob", "(", "melten", ")"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", and denote them as ",
 StyleBox["pFrozen", "Input"],
 " and ",
 StyleBox["pMelten", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.6062091245639753`*^9, 3.6062092319370756`*^9}, {
   3.6062092809118633`*^9, 3.6062094357476606`*^9}, 3.606209474316846*^9, {
   3.606209566015061*^9, 3.6062095781927476`*^9}, {3.6062096167469387`*^9, 
   3.606209825138777*^9}, {3.6062102758063803`*^9, 3.6062103999854345`*^9}, {
   3.6062105647687974`*^9, 3.6062105877371016`*^9}, 3.606210629662488*^9, {
   3.6062106599082055`*^9, 3.60621069202703*^9}, {3.6062124748693156`*^9, 
   3.6062125183337793`*^9}, {3.6062125525257225`*^9, 3.606212595797186*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MapIndexed", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Framed", "@", 
       RowBox[{"Grid", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"#1", ",", "\"\<,\>\""}], "]"}], ",", "20"}], "]"}], 
            ",", "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ruleDisplayFunc", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Normal", "[", 
                  RowBox[{"SparseArray", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", "#1"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}], "\[Rule]", "#2"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", "#3"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"3", ",", "2"}], "}"}], "\[Rule]", "#4"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}], "\[Rule]", "#5"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", "#6"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", ".5"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "3"}], "}"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "&"}], "@@", "#1"}], 
               ",", "1"}], "]"}], "//", 
             RowBox[{
              RowBox[{"Show", "[", 
               RowBox[{"#", ",", 
                RowBox[{"ImageSize", "\[Rule]", "120"}]}], "]"}], "&"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<\[LongRightArrow]   \>\"", ",", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"TraditionalForm", "[", 
                    SubscriptBox[
                    RowBox[{"P", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<frozen\>\"", ",", "12"}], "]"}], "]"}], 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]], "]"}], "]"}], ",", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"TraditionalForm", "[", 
                    SubscriptBox[
                    RowBox[{"P", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<melten\>\"", ",", "12"}], "]"}], "]"}], 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]], "]"}], "]"}]}], "}"}], 
                  "]"}]}], "}"}], "]"}], ",", "15"}], "]"}]}], 
           "\[IndentingNewLine]", "}"}]}], "}"}], "]"}]}], "&"}], ",", 
     RowBox[{"stateClsSet", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], "//", 
   RowBox[{
    RowBox[{"Partition", "[", 
     RowBox[{"#", ",", "4"}], "]"}], "&"}]}], "//", "Grid"}]], "Input",
 CellChangeTimes->{{3.6062110606929693`*^9, 3.60621120642825*^9}, {
  3.6062112524788647`*^9, 3.606211255537038*^9}, {3.6062113007606134`*^9, 
  3.606211368045436*^9}, {3.6062114040914783`*^9, 3.6062114483499937`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     FrameBox[
      TagBox[GridBox[{
         {
          StyleBox[
           TemplateBox[{",","\",\"","0","0","0","0","0","1"},
            "RowWithSeparators"],
           StripOnInput->False,
           FontSize->20], "\<\"\"\>"},
         {
          GraphicsBox[{
            {EdgeForm[RGBColor[
             0.5147073333333334, 0.6164133333333334, 0.665802]], FaceForm[
             RGBColor[0.772061, 0.92462, 0.998703]], 
             PolygonBox[{{{0.5000000000000001, 1.4433756729740645`}, {
              5.551115123125783*^-17, 
              1.1547005383792517`}, {-1.1102230246251565`*^-16, 
              0.5773502691896257}, {0.49999999999999967`, 
              0.28867513459481275`}, {0.9999999999999998, 
              0.5773502691896252}, {1.0000000000000002`, 
              1.1547005383792515`}}}]}, 
            {EdgeForm[GrayLevel[0.7]], FaceForm[GrayLevel[0.3]], 
             PolygonBox[CompressedData["
1:eJxVkDEOAVEQhsfuEq0GwSY0CtE5wEzjAmqVRC3RuYVbuALV3sEB2KAnItnX
sHbfm3+T95Ip/vwz38z7R6vNYh0SUb2oRlFBUTUq34sHs/38sAvESkr5NL0s
txOSX16+K9/50251M/5a/dT+N1uZZ5yq73iGjzrveCQ+31R8aPDdvrziOz8S
8KF9fiQPzyeJvXnsv+m9ofSsPqvflI760NiPfGLPT3mo88in73SCfLQ/QT5j
9ZGPvx/3gm8qPjT4yAd8/B98aPD/zNW1+A==
              "]], 
             {EdgeForm[None], FaceForm[RGBColor[0.85, 0.7, 0.85]], 
              PolygonBox[{{1.5000000000000002`, 1.4433756729740645`}, {1., 
               1.1547005383792517`}, {0.9999999999999999, 
               0.5773502691896257}, {1.4999999999999996`, 
               0.28867513459481275`}, {1.9999999999999998`, 
               0.5773502691896252}, {2., 1.1547005383792515`}}]}}},
           Background->GrayLevel[1],
           ImageSize->120], 
          StyleBox[
           TemplateBox[{"\"\[LongRightArrow]   \"",TagBox[
              
              GridBox[{{
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
frozen\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_1\\)\""}, {
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
melten\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_1\\)\""}}, 
               DefaultBaseStyle -> "Column", 
               GridBoxAlignment -> {"Columns" -> {{Left}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
              "Column"]},
            "RowDefault"],
           StripOnInput->False,
           FontSize->15]}
        },
        AutoDelete->False,
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"],
      StripOnInput->False], 
     FrameBox[
      TagBox[GridBox[{
         {
          StyleBox[
           TemplateBox[{",","\",\"","0","0","0","0","1","1"},
            "RowWithSeparators"],
           StripOnInput->False,
           FontSize->20], "\<\"\"\>"},
         {
          GraphicsBox[{
            {EdgeForm[RGBColor[
             0.5147073333333334, 0.6164133333333334, 0.665802]], FaceForm[
             RGBColor[0.772061, 0.92462, 0.998703]], 
             PolygonBox[{{{0.5000000000000001, 1.4433756729740645`}, {
              5.551115123125783*^-17, 
              1.1547005383792517`}, {-1.1102230246251565`*^-16, 
              0.5773502691896257}, {0.49999999999999967`, 
              0.28867513459481275`}, {0.9999999999999998, 
              0.5773502691896252}, {1.0000000000000002`, 
              1.1547005383792515`}}, {{1.0000000000000002`, 
              0.5773502691896258}, {0.5, 0.2886751345948131}, {
              0.4999999999999999, -0.2886751345948128}, {
              0.9999999999999997, -0.5773502691896258}, {
              1.4999999999999998`, -0.2886751345948134}, {1.5000000000000002`,
               0.28867513459481275`}}}]}, 
            {EdgeForm[GrayLevel[0.7]], FaceForm[GrayLevel[0.3]], 
             PolygonBox[CompressedData["
1:eJxTTMoPSmVmYGBgAWI2IGYCYkYGEPhgL2M8wXV5JZMDmMvwwH6nzr2YIi0G
h3//QeC+/WP7L2KCEt/t/4L576HqP9mDuf+/2z+AykPM+2G/A6ofYh6DA6r5
P+Dmw/gw8yH2/YebD5FncYCZD+Ojms/i8ARFnsFBFkU/zP5HUPcyO0iB+Zeg
8hwO4lB5GF8GTb8sivwPewUU/T/spSH8/TD3Q9Xvh7lPDSoP48PsBwBhyIdY

              "]], 
             {EdgeForm[None], FaceForm[RGBColor[0.85, 0.7, 0.85]], 
              PolygonBox[{{1.5000000000000002`, 1.4433756729740645`}, {1., 
               1.1547005383792517`}, {0.9999999999999999, 
               0.5773502691896257}, {1.4999999999999996`, 
               0.28867513459481275`}, {1.9999999999999998`, 
               0.5773502691896252}, {2., 1.1547005383792515`}}]}}},
           Background->GrayLevel[1],
           ImageSize->120], 
          StyleBox[
           TemplateBox[{"\"\[LongRightArrow]   \"",TagBox[
              
              GridBox[{{
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
frozen\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_2\\)\""}, {
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
melten\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_2\\)\""}}, 
               DefaultBaseStyle -> "Column", 
               GridBoxAlignment -> {"Columns" -> {{Left}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
              "Column"]},
            "RowDefault"],
           StripOnInput->False,
           FontSize->15]}
        },
        AutoDelete->False,
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"],
      StripOnInput->False], 
     FrameBox[
      TagBox[GridBox[{
         {
          StyleBox[
           TemplateBox[{",","\",\"","0","0","0","1","0","1"},
            "RowWithSeparators"],
           StripOnInput->False,
           FontSize->20], "\<\"\"\>"},
         {
          GraphicsBox[{
            {EdgeForm[RGBColor[
             0.5147073333333334, 0.6164133333333334, 0.665802]], FaceForm[
             RGBColor[0.772061, 0.92462, 0.998703]], 
             PolygonBox[{{{0.5000000000000001, 1.4433756729740645`}, {
              5.551115123125783*^-17, 
              1.1547005383792517`}, {-1.1102230246251565`*^-16, 
              0.5773502691896257}, {0.49999999999999967`, 
              0.28867513459481275`}, {0.9999999999999998, 
              0.5773502691896252}, {1.0000000000000002`, 
              1.1547005383792515`}}, {{2., 0.5773502691896258}, {1.5, 
              0.2886751345948131}, {1.5, -0.2886751345948128}, {
              1.9999999999999996`, -0.5773502691896258}, {
              2.5, -0.2886751345948134}, {2.5, 0.28867513459481275`}}}]}, 
            {EdgeForm[GrayLevel[0.7]], FaceForm[GrayLevel[0.3]], 
             PolygonBox[CompressedData["
1:eJxTTMoPSmVmYGBgAWI2IGYCYkYGEPhgL2M8wXV5JZMDmMvwwH6nzr2YIi0G
h3//QeC+/WP7L2KCEt/t/4L576HqP9mDuf+/2z+AykPM+2G/A6ofYh6DA6r5
P+Dmw/gw8yH2/YebD5FncYCZD+Ojms/i8ARFnsFBFkU/zP5HUPcyO0iB+Zeg
8hwO4lB5GB9mPyx8ZFHkH9grQPXDwkcawt8PCx+o+v2w8FGDysPCB2Y/AOil
ld8=
              "]], 
             {EdgeForm[None], FaceForm[RGBColor[0.85, 0.7, 0.85]], 
              PolygonBox[{{1.5000000000000002`, 1.4433756729740645`}, {1., 
               1.1547005383792517`}, {0.9999999999999999, 
               0.5773502691896257}, {1.4999999999999996`, 
               0.28867513459481275`}, {1.9999999999999998`, 
               0.5773502691896252}, {2., 1.1547005383792515`}}]}}},
           Background->GrayLevel[1],
           ImageSize->120], 
          StyleBox[
           TemplateBox[{"\"\[LongRightArrow]   \"",TagBox[
              
              GridBox[{{
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
frozen\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_3\\)\""}, {
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
melten\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_3\\)\""}}, 
               DefaultBaseStyle -> "Column", 
               GridBoxAlignment -> {"Columns" -> {{Left}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
              "Column"]},
            "RowDefault"],
           StripOnInput->False,
           FontSize->15]}
        },
        AutoDelete->False,
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"],
      StripOnInput->False], 
     FrameBox[
      TagBox[GridBox[{
         {
          StyleBox[
           TemplateBox[{",","\",\"","0","0","0","1","1","1"},
            "RowWithSeparators"],
           StripOnInput->False,
           FontSize->20], "\<\"\"\>"},
         {
          GraphicsBox[{
            {EdgeForm[RGBColor[
             0.5147073333333334, 0.6164133333333334, 0.665802]], FaceForm[
             RGBColor[0.772061, 0.92462, 0.998703]], 
             PolygonBox[{{{0.5000000000000001, 1.4433756729740645`}, {
              5.551115123125783*^-17, 
              1.1547005383792517`}, {-1.1102230246251565`*^-16, 
              0.5773502691896257}, {0.49999999999999967`, 
              0.28867513459481275`}, {0.9999999999999998, 
              0.5773502691896252}, {1.0000000000000002`, 
              1.1547005383792515`}}, {{1.0000000000000002`, 
              0.5773502691896258}, {0.5, 0.2886751345948131}, {
              0.4999999999999999, -0.2886751345948128}, {
              0.9999999999999997, -0.5773502691896258}, {
              1.4999999999999998`, -0.2886751345948134}, {1.5000000000000002`,
               0.28867513459481275`}}, {{2., 0.5773502691896258}, {1.5, 
              0.2886751345948131}, {1.5, -0.2886751345948128}, {
              1.9999999999999996`, -0.5773502691896258}, {
              2.5, -0.2886751345948134}, {2.5, 0.28867513459481275`}}}]}, 
            {EdgeForm[GrayLevel[0.7]], FaceForm[GrayLevel[0.3]], 
             PolygonBox[{{{1.0000000000000002`, 2.309401076758503}, {0.5, 
              2.0207259421636903`}, {0.4999999999999999, 
              1.4433756729740643`}, {0.9999999999999997, 
              1.1547005383792515`}, {1.4999999999999998`, 
              1.4433756729740637`}, {1.5000000000000002`, 
              2.02072594216369}}, {{2., 2.309401076758503}, {1.5, 
              2.0207259421636903`}, {1.5, 1.4433756729740643`}, {
              1.9999999999999996`, 1.1547005383792515`}, {2.5, 
              1.4433756729740637`}, {2.5, 2.02072594216369}}, {{2.5, 
              1.4433756729740645`}, {2., 1.1547005383792517`}, {2., 
              0.5773502691896257}, {2.4999999999999996`, 
              0.28867513459481275`}, {3., 0.5773502691896252}, {3., 
              1.1547005383792515`}}}], 
             {EdgeForm[None], FaceForm[RGBColor[0.85, 0.7, 0.85]], 
              PolygonBox[{{1.5000000000000002`, 1.4433756729740645`}, {1., 
               1.1547005383792517`}, {0.9999999999999999, 
               0.5773502691896257}, {1.4999999999999996`, 
               0.28867513459481275`}, {1.9999999999999998`, 
               0.5773502691896252}, {2., 1.1547005383792515`}}]}}},
           Background->GrayLevel[1],
           ImageSize->120], 
          StyleBox[
           TemplateBox[{"\"\[LongRightArrow]   \"",TagBox[
              
              GridBox[{{
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
frozen\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_4\\)\""}, {
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
melten\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_4\\)\""}}, 
               DefaultBaseStyle -> "Column", 
               GridBoxAlignment -> {"Columns" -> {{Left}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
              "Column"]},
            "RowDefault"],
           StripOnInput->False,
           FontSize->15]}
        },
        AutoDelete->False,
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"],
      StripOnInput->False]},
    {
     FrameBox[
      TagBox[GridBox[{
         {
          StyleBox[
           TemplateBox[{",","\",\"","0","0","1","0","0","1"},
            "RowWithSeparators"],
           StripOnInput->False,
           FontSize->20], "\<\"\"\>"},
         {
          GraphicsBox[{
            {EdgeForm[RGBColor[
             0.5147073333333334, 0.6164133333333334, 0.665802]], FaceForm[
             RGBColor[0.772061, 0.92462, 0.998703]], 
             PolygonBox[{{{0.5000000000000001, 1.4433756729740645`}, {
              5.551115123125783*^-17, 
              1.1547005383792517`}, {-1.1102230246251565`*^-16, 
              0.5773502691896257}, {0.49999999999999967`, 
              0.28867513459481275`}, {0.9999999999999998, 
              0.5773502691896252}, {1.0000000000000002`, 
              1.1547005383792515`}}, {{2.5, 1.4433756729740645`}, {2., 
              1.1547005383792517`}, {2., 0.5773502691896257}, {
              2.4999999999999996`, 0.28867513459481275`}, {3., 
              0.5773502691896252}, {3., 1.1547005383792515`}}}]}, 
            {EdgeForm[GrayLevel[0.7]], FaceForm[GrayLevel[0.3]], 
             PolygonBox[CompressedData["
1:eJxTTMoPSmVmYGBgAWI2IGYCYkYGEPhgL2M8wXV5JZMDmMvwwH6nzr2YIi0G
h3//QeC+/WP7L2KCEt/t/4L576HqP9mDuf+/2z+AykPM+2G/A6ofYh6DA6r5
P+Dmw/gw8yH2/YebD5FncYCZD+PDzIe5Xxas/pE9zP0KYP4le5j7pSH8/TD3
Q9Xvh7lfDSoPc78UVD/M/ajm/4CbD+PDzIe5H2Y+zL0w82F8mPkAl+qZ1w==

              "]], 
             {EdgeForm[None], FaceForm[RGBColor[0.85, 0.7, 0.85]], 
              PolygonBox[{{1.5000000000000002`, 1.4433756729740645`}, {1., 
               1.1547005383792517`}, {0.9999999999999999, 
               0.5773502691896257}, {1.4999999999999996`, 
               0.28867513459481275`}, {1.9999999999999998`, 
               0.5773502691896252}, {2., 1.1547005383792515`}}]}}},
           Background->GrayLevel[1],
           ImageSize->120], 
          StyleBox[
           TemplateBox[{"\"\[LongRightArrow]   \"",TagBox[
              
              GridBox[{{
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
frozen\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_5\\)\""}, {
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
melten\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_5\\)\""}}, 
               DefaultBaseStyle -> "Column", 
               GridBoxAlignment -> {"Columns" -> {{Left}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
              "Column"]},
            "RowDefault"],
           StripOnInput->False,
           FontSize->15]}
        },
        AutoDelete->False,
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"],
      StripOnInput->False], 
     FrameBox[
      TagBox[GridBox[{
         {
          StyleBox[
           TemplateBox[{",","\",\"","0","0","1","0","1","1"},
            "RowWithSeparators"],
           StripOnInput->False,
           FontSize->20], "\<\"\"\>"},
         {
          GraphicsBox[{
            {EdgeForm[RGBColor[
             0.5147073333333334, 0.6164133333333334, 0.665802]], FaceForm[
             RGBColor[0.772061, 0.92462, 0.998703]], 
             PolygonBox[{{{0.5000000000000001, 1.4433756729740645`}, {
              5.551115123125783*^-17, 
              1.1547005383792517`}, {-1.1102230246251565`*^-16, 
              0.5773502691896257}, {0.49999999999999967`, 
              0.28867513459481275`}, {0.9999999999999998, 
              0.5773502691896252}, {1.0000000000000002`, 
              1.1547005383792515`}}, {{2.5, 1.4433756729740645`}, {2., 
              1.1547005383792517`}, {2., 0.5773502691896257}, {
              2.4999999999999996`, 0.28867513459481275`}, {3., 
              0.5773502691896252}, {3., 1.1547005383792515`}}, {{
              1.0000000000000002`, 0.5773502691896258}, {0.5, 
              0.2886751345948131}, {
              0.4999999999999999, -0.2886751345948128}, {
              0.9999999999999997, -0.5773502691896258}, {
              1.4999999999999998`, -0.2886751345948134}, {1.5000000000000002`,
               0.28867513459481275`}}}]}, 
            {EdgeForm[GrayLevel[0.7]], FaceForm[GrayLevel[0.3]], 
             PolygonBox[{{{1.0000000000000002`, 2.309401076758503}, {0.5, 
              2.0207259421636903`}, {0.4999999999999999, 
              1.4433756729740643`}, {0.9999999999999997, 
              1.1547005383792515`}, {1.4999999999999998`, 
              1.4433756729740637`}, {1.5000000000000002`, 
              2.02072594216369}}, {{2., 2.309401076758503}, {1.5, 
              2.0207259421636903`}, {1.5, 1.4433756729740643`}, {
              1.9999999999999996`, 1.1547005383792515`}, {2.5, 
              1.4433756729740637`}, {2.5, 2.02072594216369}}, {{2., 
              0.5773502691896258}, {1.5, 0.2886751345948131}, {
              1.5, -0.2886751345948128}, {
              1.9999999999999996`, -0.5773502691896258}, {
              2.5, -0.2886751345948134}, {2.5, 0.28867513459481275`}}}], 
             {EdgeForm[None], FaceForm[RGBColor[0.85, 0.7, 0.85]], 
              PolygonBox[{{1.5000000000000002`, 1.4433756729740645`}, {1., 
               1.1547005383792517`}, {0.9999999999999999, 
               0.5773502691896257}, {1.4999999999999996`, 
               0.28867513459481275`}, {1.9999999999999998`, 
               0.5773502691896252}, {2., 1.1547005383792515`}}]}}},
           Background->GrayLevel[1],
           ImageSize->120], 
          StyleBox[
           TemplateBox[{"\"\[LongRightArrow]   \"",TagBox[
              GridBox[{{
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
frozen\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_6\\)\""}, {
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
melten\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_6\\)\""}}, 
               DefaultBaseStyle -> "Column", 
               GridBoxAlignment -> {"Columns" -> {{Left}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
              "Column"]},
            "RowDefault"],
           StripOnInput->False,
           FontSize->15]}
        },
        AutoDelete->False,
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"],
      StripOnInput->False], 
     FrameBox[
      TagBox[GridBox[{
         {
          StyleBox[
           TemplateBox[{",","\",\"","0","0","1","1","1","1"},
            "RowWithSeparators"],
           StripOnInput->False,
           FontSize->20], "\<\"\"\>"},
         {
          GraphicsBox[{
            {EdgeForm[RGBColor[
             0.5147073333333334, 0.6164133333333334, 0.665802]], FaceForm[
             RGBColor[0.772061, 0.92462, 0.998703]], 
             PolygonBox[CompressedData["
1:eJxTTMoPSmVmYGBgAWI2IGYCYkYGEHhg/8T+i5igxHd7MJdhgo2s8QTX5ZWf
oPwFe2TA/Ef2v/6DwH17KTD/kv0/MP+9vThUHmLeB3sZFP0sDqjmMzigms/g
ADMfbNx/ZgeY+RBpDgeY+TA+zHyYfbIo8g/sFVDcd99eGsLf/xfqXqj6/RD7
vturQeUh5v2wR7Uf5l6Y+T/g5sP4MPMh9v2Hmw/zP8x8GB9mPgDWOJPR
              "]]}, 
            {EdgeForm[GrayLevel[0.7]], FaceForm[GrayLevel[0.3]], 
             PolygonBox[{{{1.0000000000000002`, 2.309401076758503}, {0.5, 
              2.0207259421636903`}, {0.4999999999999999, 
              1.4433756729740643`}, {0.9999999999999997, 
              1.1547005383792515`}, {1.4999999999999998`, 
              1.4433756729740637`}, {1.5000000000000002`, 
              2.02072594216369}}, {{2., 2.309401076758503}, {1.5, 
              2.0207259421636903`}, {1.5, 1.4433756729740643`}, {
              1.9999999999999996`, 1.1547005383792515`}, {2.5, 
              1.4433756729740637`}, {2.5, 2.02072594216369}}}], 
             {EdgeForm[None], FaceForm[RGBColor[0.85, 0.7, 0.85]], 
              PolygonBox[{{1.5000000000000002`, 1.4433756729740645`}, {1., 
               1.1547005383792517`}, {0.9999999999999999, 
               0.5773502691896257}, {1.4999999999999996`, 
               0.28867513459481275`}, {1.9999999999999998`, 
               0.5773502691896252}, {2., 1.1547005383792515`}}]}}},
           Background->GrayLevel[1],
           ImageSize->120], 
          StyleBox[
           TemplateBox[{"\"\[LongRightArrow]   \"",TagBox[
              
              GridBox[{{
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
frozen\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_7\\)\""}, {
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
melten\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_7\\)\""}}, 
               DefaultBaseStyle -> "Column", 
               GridBoxAlignment -> {"Columns" -> {{Left}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
              "Column"]},
            "RowDefault"],
           StripOnInput->False,
           FontSize->15]}
        },
        AutoDelete->False,
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"],
      StripOnInput->False], 
     FrameBox[
      TagBox[GridBox[{
         {
          StyleBox[
           TemplateBox[{",","\",\"","0","1","0","1","0","1"},
            "RowWithSeparators"],
           StripOnInput->False,
           FontSize->20], "\<\"\"\>"},
         {
          GraphicsBox[{
            {EdgeForm[RGBColor[
             0.5147073333333334, 0.6164133333333334, 0.665802]], FaceForm[
             RGBColor[0.772061, 0.92462, 0.998703]], 
             PolygonBox[{{{2., 2.309401076758503}, {1.5, 
              2.0207259421636903`}, {1.5, 1.4433756729740643`}, {
              1.9999999999999996`, 1.1547005383792515`}, {2.5, 
              1.4433756729740637`}, {2.5, 2.02072594216369}}, {{
              0.5000000000000001, 1.4433756729740645`}, {
              5.551115123125783*^-17, 
              1.1547005383792517`}, {-1.1102230246251565`*^-16, 
              0.5773502691896257}, {0.49999999999999967`, 
              0.28867513459481275`}, {0.9999999999999998, 
              0.5773502691896252}, {1.0000000000000002`, 
              1.1547005383792515`}}, {{2., 0.5773502691896258}, {1.5, 
              0.2886751345948131}, {1.5, -0.2886751345948128}, {
              1.9999999999999996`, -0.5773502691896258}, {
              2.5, -0.2886751345948134}, {2.5, 0.28867513459481275`}}}]}, 
            {EdgeForm[GrayLevel[0.7]], FaceForm[GrayLevel[0.3]], 
             PolygonBox[{{{1.0000000000000002`, 2.309401076758503}, {0.5, 
              2.0207259421636903`}, {0.4999999999999999, 
              1.4433756729740643`}, {0.9999999999999997, 
              1.1547005383792515`}, {1.4999999999999998`, 
              1.4433756729740637`}, {1.5000000000000002`, 
              2.02072594216369}}, {{2.5, 1.4433756729740645`}, {2., 
              1.1547005383792517`}, {2., 0.5773502691896257}, {
              2.4999999999999996`, 0.28867513459481275`}, {3., 
              0.5773502691896252}, {3., 1.1547005383792515`}}, {{
              1.0000000000000002`, 0.5773502691896258}, {0.5, 
              0.2886751345948131}, {
              0.4999999999999999, -0.2886751345948128}, {
              0.9999999999999997, -0.5773502691896258}, {
              1.4999999999999998`, -0.2886751345948134}, {1.5000000000000002`,
               0.28867513459481275`}}}], 
             {EdgeForm[None], FaceForm[RGBColor[0.85, 0.7, 0.85]], 
              PolygonBox[{{1.5000000000000002`, 1.4433756729740645`}, {1., 
               1.1547005383792517`}, {0.9999999999999999, 
               0.5773502691896257}, {1.4999999999999996`, 
               0.28867513459481275`}, {1.9999999999999998`, 
               0.5773502691896252}, {2., 1.1547005383792515`}}]}}},
           Background->GrayLevel[1],
           ImageSize->120], 
          StyleBox[
           TemplateBox[{"\"\[LongRightArrow]   \"",TagBox[
              
              GridBox[{{
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
frozen\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_8\\)\""}, {
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
melten\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_8\\)\""}}, 
               DefaultBaseStyle -> "Column", 
               GridBoxAlignment -> {"Columns" -> {{Left}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
              "Column"]},
            "RowDefault"],
           StripOnInput->False,
           FontSize->15]}
        },
        AutoDelete->False,
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"],
      StripOnInput->False]},
    {
     FrameBox[
      TagBox[GridBox[{
         {
          StyleBox[
           TemplateBox[{",","\",\"","0","1","0","1","1","1"},
            "RowWithSeparators"],
           StripOnInput->False,
           FontSize->20], "\<\"\"\>"},
         {
          GraphicsBox[{
            {EdgeForm[RGBColor[
             0.5147073333333334, 0.6164133333333334, 0.665802]], FaceForm[
             RGBColor[0.772061, 0.92462, 0.998703]], 
             PolygonBox[CompressedData["
1:eJxTTMoPSmVmYGBgAWI2IGZigAMHGeMJrssrmRwg3B/2O3XuxRRpMcD5j+2/
iAlKfLf/9x8M7CHqP9lD5FkcHkDlYfwdUP2MYP4D+yco8hNsZFH0L9gDMe+R
/S+w8fftpcD8S1D73tuLQ+Uh5n2A2w/jy0LlGaD2KaDov28vDeHv/ws1D6p+
P8Q73+3VoPKMUP/C7IeFD6r5P+Dmw/gw82HhAzMfFh4w82F8mPkAcUSVIQ==

              "]]}, 
            {EdgeForm[GrayLevel[0.7]], FaceForm[GrayLevel[0.3]], 
             PolygonBox[{{{1.0000000000000002`, 2.309401076758503}, {0.5, 
              2.0207259421636903`}, {0.4999999999999999, 
              1.4433756729740643`}, {0.9999999999999997, 
              1.1547005383792515`}, {1.4999999999999998`, 
              1.4433756729740637`}, {1.5000000000000002`, 
              2.02072594216369}}, {{2.5, 1.4433756729740645`}, {2., 
              1.1547005383792517`}, {2., 0.5773502691896257}, {
              2.4999999999999996`, 0.28867513459481275`}, {3., 
              0.5773502691896252}, {3., 1.1547005383792515`}}}], 
             {EdgeForm[None], FaceForm[RGBColor[0.85, 0.7, 0.85]], 
              PolygonBox[{{1.5000000000000002`, 1.4433756729740645`}, {1., 
               1.1547005383792517`}, {0.9999999999999999, 
               0.5773502691896257}, {1.4999999999999996`, 
               0.28867513459481275`}, {1.9999999999999998`, 
               0.5773502691896252}, {2., 1.1547005383792515`}}]}}},
           Background->GrayLevel[1],
           ImageSize->120], 
          StyleBox[
           TemplateBox[{"\"\[LongRightArrow]   \"",TagBox[
              
              GridBox[{{
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
frozen\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_9\\)\""}, {
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
melten\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_9\\)\""}}, 
               DefaultBaseStyle -> "Column", 
               GridBoxAlignment -> {"Columns" -> {{Left}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
              "Column"]},
            "RowDefault"],
           StripOnInput->False,
           FontSize->15]}
        },
        AutoDelete->False,
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"],
      StripOnInput->False], 
     FrameBox[
      TagBox[GridBox[{
         {
          StyleBox[
           TemplateBox[{",","\",\"","0","1","1","0","1","1"},
            "RowWithSeparators"],
           StripOnInput->False,
           FontSize->20], "\<\"\"\>"},
         {
          GraphicsBox[{
            {EdgeForm[RGBColor[
             0.5147073333333334, 0.6164133333333334, 0.665802]], FaceForm[
             RGBColor[0.772061, 0.92462, 0.998703]], 
             PolygonBox[CompressedData["
1:eJxTTMoPSmVmYGBgAWI2IGZigAMHGeMJrssrmRwg3B/2O3XuxRRpMcD5j+2/
iAlKfLf/9x8M7CHqP9lD5FkcHkDlYfwdUP2MYP4D+yco8hNsZFH0L9gDMe+R
/S+w8fftpcD8S1D73tuLQ+Uh5n3AsB/VfAYHVPNh/ntkD3E+swPMfIg0hwPM
fBgfZj7MPlkU+Qf2Cijuu28vDeHv/wt1L1T9foh93+3VoPKM0PCE2Q8Awf+R
KQ==
              "]]}, 
            {EdgeForm[GrayLevel[0.7]], FaceForm[GrayLevel[0.3]], 
             PolygonBox[{{{1.0000000000000002`, 2.309401076758503}, {0.5, 
              2.0207259421636903`}, {0.4999999999999999, 
              1.4433756729740643`}, {0.9999999999999997, 
              1.1547005383792515`}, {1.4999999999999998`, 
              1.4433756729740637`}, {1.5000000000000002`, 
              2.02072594216369}}, {{2., 0.5773502691896258}, {1.5, 
              0.2886751345948131}, {1.5, -0.2886751345948128}, {
              1.9999999999999996`, -0.5773502691896258}, {
              2.5, -0.2886751345948134}, {2.5, 0.28867513459481275`}}}], 
             {EdgeForm[None], FaceForm[RGBColor[0.85, 0.7, 0.85]], 
              PolygonBox[{{1.5000000000000002`, 1.4433756729740645`}, {1., 
               1.1547005383792517`}, {0.9999999999999999, 
               0.5773502691896257}, {1.4999999999999996`, 
               0.28867513459481275`}, {1.9999999999999998`, 
               0.5773502691896252}, {2., 1.1547005383792515`}}]}}},
           Background->GrayLevel[1],
           ImageSize->120], 
          StyleBox[
           TemplateBox[{"\"\[LongRightArrow]   \"",TagBox[
              
              GridBox[{{
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
frozen\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_10\\)\""}, {
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
melten\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_10\\)\""}}, 
               DefaultBaseStyle -> "Column", 
               GridBoxAlignment -> {"Columns" -> {{Left}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
              "Column"]},
            "RowDefault"],
           StripOnInput->False,
           FontSize->15]}
        },
        AutoDelete->False,
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"],
      StripOnInput->False], 
     FrameBox[
      TagBox[GridBox[{
         {
          StyleBox[
           TemplateBox[{",","\",\"","0","1","1","1","1","1"},
            "RowWithSeparators"],
           StripOnInput->False,
           FontSize->20], "\<\"\"\>"},
         {
          GraphicsBox[{
            {EdgeForm[RGBColor[
             0.5147073333333334, 0.6164133333333334, 0.665802]], FaceForm[
             RGBColor[0.772061, 0.92462, 0.998703]], 
             PolygonBox[CompressedData["
1:eJxTTMoPSmVmYGBgBWI2IGZigAMHGeMJrssrmRwg3B/2O3XuxRRpMcD5j+2/
iAlKfLf/9x8M7CHqP9lD5FkcHkDlYfwdUP2MYP4D+yco8hNsZFH0L9gDMe+R
/S+w8fftpcD8S1D73tuLQ+Uh5n3AsB/VfAYHVPNh/ntkD3E+swPMfIg0hwPM
fBgfZj7MPlkU+Qf2Cijuu28vDeHv/wt1L1T9foh93+3VoPKM0PBEtR/mXpj5
P+Dmw/gw82HhDzMf5n+Y+TA+zHwA4dGxQg==
              "]]}, 
            {EdgeForm[GrayLevel[0.7]], FaceForm[GrayLevel[0.3]], 
             PolygonBox[{{{1.0000000000000002`, 2.309401076758503}, {0.5, 
              2.0207259421636903`}, {0.4999999999999999, 
              1.4433756729740643`}, {0.9999999999999997, 
              1.1547005383792515`}, {1.4999999999999998`, 
              1.4433756729740637`}, {1.5000000000000002`, 
              2.02072594216369}}}], 
             {EdgeForm[None], FaceForm[RGBColor[0.85, 0.7, 0.85]], 
              PolygonBox[{{1.5000000000000002`, 1.4433756729740645`}, {1., 
               1.1547005383792517`}, {0.9999999999999999, 
               0.5773502691896257}, {1.4999999999999996`, 
               0.28867513459481275`}, {1.9999999999999998`, 
               0.5773502691896252}, {2., 1.1547005383792515`}}]}}},
           Background->GrayLevel[1],
           ImageSize->120], 
          StyleBox[
           TemplateBox[{"\"\[LongRightArrow]   \"",TagBox[
              
              GridBox[{{
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
frozen\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_11\\)\""}, {
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
melten\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_11\\)\""}}, 
               DefaultBaseStyle -> "Column", 
               GridBoxAlignment -> {"Columns" -> {{Left}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
              "Column"]},
            "RowDefault"],
           StripOnInput->False,
           FontSize->15]}
        },
        AutoDelete->False,
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}
         ],
       "Grid"],
      StripOnInput->False], 
     FrameBox[
      TagBox[GridBox[{
         {
          StyleBox[
           TemplateBox[{",","\",\"","1","1","1","1","1","1"},
            "RowWithSeparators"],
           StripOnInput->False,
           FontSize->20], "\<\"\"\>"},
         {
          GraphicsBox[{
            {EdgeForm[RGBColor[
             0.5147073333333334, 0.6164133333333334, 0.665802]], FaceForm[
             RGBColor[0.772061, 0.92462, 0.998703]], 
             PolygonBox[CompressedData["
1:eJxVkD0KwkAQhTeJiK2Nij+gjYXY2QqzjRewthKsBTtvkSPYeQUFIXfwACZE
+4gICYJGszsvMgtbPN7u92beYLmerzylVJWv+7uOKs6duhN/tt+62kgV0XF8
WWxGSn/y4oR0pWej3krpbXTC7x9kZJ5SxL7lZXTg/5antORnJR8afJuXl3zr
VzT40OA7PO9N+P60J/7vTpYX04v3aRt95ryEmuzLPv75kq+05GO/mPvwNPjW
rmnwocFHXk/4EfXFfCF1rA7QP78P0P+QffQv8zEv+FnJhwYf/YOP/cGHBv8L
vnDdOg==
              "]]}, 
            {EdgeForm[GrayLevel[0.7]], FaceForm[GrayLevel[0.3]], 
             PolygonBox[{}], 
             {EdgeForm[None], FaceForm[RGBColor[0.85, 0.7, 0.85]], 
              PolygonBox[{{1.5000000000000002`, 1.4433756729740645`}, {1., 
               1.1547005383792517`}, {0.9999999999999999, 
               0.5773502691896257}, {1.4999999999999996`, 
               0.28867513459481275`}, {1.9999999999999998`, 
               0.5773502691896252}, {2., 1.1547005383792515`}}]}}},
           Background->GrayLevel[1],
           ImageSize->120], 
          StyleBox[
           TemplateBox[{"\"\[LongRightArrow]   \"",TagBox[
              
              GridBox[{{
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
frozen\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_12\\)\""}, {
                "\"\\!\\(TraditionalForm\\`\\(P(\\(\\(\\*StyleBox[\\\"\\\\\\\"\
melten\\\\\\\"\\\", 12, Rule[StripOnInput, False]]\\)\\))\\)\\_12\\)\""}}, 
               DefaultBaseStyle -> "Column", 
               GridBoxAlignment -> {"Columns" -> {{Left}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
              "Column"]},
            "RowDefault"],
           StripOnInput->False,
           FontSize->15]}
        },
        AutoDelete->False,
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"],
      StripOnInput->False]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.606211037362644*^9, 3.6062111132799573`*^9}, {
   3.606211143720687*^9, 3.6062112079083366`*^9}, 3.6062112563190827`*^9, {
   3.6062113402358513`*^9, 3.606211369156494*^9}, {3.606211412378949*^9, 
   3.606211448811019*^9}}]
}, {2}]],

Cell[TextData[{
 "Back to physics / thermodynamics, those 24 probabilities, ",
 StyleBox["pFrozen", "Input"],
 " and ",
 StyleBox["pMelten", "Input"],
 ", can of corse be determined by serious physical models, or they can be \
chosen randomly just for fun. For example, an intuitive (and naive) idea \
would be to believe an empty cell nearby a sharp pointed end or with abundant \
moisture source will have a high ",
 StyleBox["pFrozen", "Input"],
 ". (People who are interested in the serious physical models should not miss \
the Gravner-Griffeath Snowfakes model ",
 "http://psoup.math.wisc.edu/Snowfakes.htm",
 " .)"
}], "Text",
 CellChangeTimes->{{3.6062106977493534`*^9, 3.606210790082596*^9}, {
  3.6062114949506397`*^9, 3.606211509858493*^9}, {3.606211540049203*^9, 
  3.6062117038215055`*^9}, {3.606211740459588*^9, 3.6062117459268975`*^9}, {
  3.6062117766196423`*^9, 3.606211801467054*^9}, {3.6062118419343576`*^9, 
  3.606211908126113*^9}, {3.6062119591880145`*^9, 3.606211985847534*^9}, {
  3.606212023034647*^9, 3.6062120405736384`*^9}, {3.606212143544489*^9, 
  3.606212155199151*^9}, {3.6062122047409644`*^9, 3.6062123444479003`*^9}}],

Cell["\<\
Now we have the grid, the stencil, the neighborhood arrangement set and the \
transfer probabilities, we\[CloseCurlyQuote]re offically ready to construct \
our cellular automaton rules.\
\>", "Text",
 CellChangeTimes->{{3.6062124081795216`*^9, 3.606212440741373*^9}, {
  3.606212623908777*^9, 3.6062126730285673`*^9}, {3.606212817845795*^9, 
  3.60621286598853*^9}}],

Cell[TextData[{
 "Following the above discussion, the construction is straightforward. There \
are only two points which need to pay attention to. One is to keep in mind \
that the rule function is applied on the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"3", "\[Times]", "3"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " stencil, so even ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["cell", 
    RowBox[{"1", ",", "1"}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["cell", 
    RowBox[{"3", ",", "3"}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " has nothing to do with our model, don\[CloseCurlyQuote]t forget handling \
them. The second is to use a ",
 StyleBox["SeedRandom", "Input"],
 " function to make sure same arrangement gives same result in same time \
step, otherwise the 6-fold rotational symmetry and 3 axes of reflection \
symmetry will both break!"
}], "Text",
 CellChangeTimes->{{3.606213028564766*^9, 3.6062131411731644`*^9}, {
  3.6062132502853637`*^9, 3.6062134420692587`*^9}, {3.6062134729490175`*^9, 
  3.6062135649252424`*^9}, {3.606215923988258*^9, 3.6062159412122364`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ruleFunc", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ruleFunc", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"stateClsSetHomogeneous", "=", "stateClsSetHomogeneous"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"seedStore", "=", 
        RowBox[{"RandomInteger", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1000"}], "}"}], ",", "1000"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"pFreeze", "=", 
        RowBox[{"{", 
         RowBox[{
         "1", ",", "0", ",", "    ", "0.6", ",", "0", ",", "    ", "0.3", ",",
           "0.15", ",", "0", ",", "   ", "0.2", ",", "0", ",", "   ", "0.2", 
          ",", "0", ",", "   ", ".8"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"pMelt", "    ", "=", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0.7", ",", "0.5", ",", "0.7", ",", "0.7", ",", "0.5", ",",
           " ", "0.3", ",", "0.5", ",", "0.3", ",", "0.2", ",", "0.1", ",", 
          "0"}], "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"neighborarry", ",", "_Integer", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step", ",", "_Integer"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"cv", ",", "neighborlst", ",", "cls", ",", "rand"}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cv", "=", 
           RowBox[{"neighborarry", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"neighborlst", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}], 
             "&"}], "[", "neighborarry", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Total", "[", "neighborlst", "]"}], "\[Equal]", "0"}], 
            ",", "cv", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cls", "=", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"stateClsSetHomogeneous", ",", "neighborlst"}], "]"}],
                "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"SeedRandom", "[", 
              RowBox[{"seedStore", "\[LeftDoubleBracket]", 
               RowBox[{"step", "+", "1"}], "\[RightDoubleBracket]"}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"rand", "=", 
              RowBox[{"RandomReal", "[", "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Boole", "@", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"cv", "\[Equal]", "0"}], ",", 
                RowBox[{"rand", "<", 
                 RowBox[{
                 "pFreeze", "\[LeftDoubleBracket]", "cls", 
                  "\[RightDoubleBracket]"}]}], ",", 
                RowBox[{"rand", ">", 
                 RowBox[{
                 "pMelt", "\[LeftDoubleBracket]", "cls", 
                  "\[RightDoubleBracket]"}]}]}], "]"}]}]}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ","}], "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"RuntimeAttributes", "\[Rule]", 
        RowBox[{"{", "Listable", "}"}]}], ",", 
       RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
       RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.5524824274716477`*^9, 3.552482496652605*^9}, {
   3.5524825275273705`*^9, 3.5524825341297483`*^9}, {3.5524826311082954`*^9, 
   3.5524826428299656`*^9}, {3.5524826784540033`*^9, 3.552482678961032*^9}, {
   3.5524866514822235`*^9, 3.552486682566002*^9}, {3.552600966409155*^9, 
   3.5526009668771563`*^9}, {3.5526010490425005`*^9, 3.5526010748917456`*^9}, 
   3.5534169415237617`*^9, {3.553420996200676*^9, 3.553421000507922*^9}, {
   3.5534217548110657`*^9, 3.5534218089351616`*^9}, {3.5534221509697247`*^9, 
   3.5534221757721434`*^9}, {3.5534222131492815`*^9, 3.553422227649111*^9}, {
   3.553422497356537*^9, 3.5534225165836368`*^9}, {3.553447308243639*^9, 
   3.553447332330016*^9}, {3.553447366007943*^9, 3.553447401907996*^9}, {
   3.553448279245177*^9, 3.5534482831624007`*^9}, {3.55344831339613*^9, 
   3.553448345581971*^9}, {3.5534484145199137`*^9, 3.5534484897102146`*^9}, {
   3.553448543247277*^9, 3.5534485565790396`*^9}, {3.5534486499233785`*^9, 
   3.5534486506554203`*^9}, {3.553448691118735*^9, 3.5534487115029006`*^9}, 
   3.553448905266983*^9, {3.5534489866226363`*^9, 3.5534490321162386`*^9}, {
   3.5534491861630497`*^9, 3.55344918739812*^9}, {3.5534492320406733`*^9, 
   3.5534493389847903`*^9}, {3.5534494618238163`*^9, 3.553449468860219*^9}, {
   3.553449825684628*^9, 3.5534498694151297`*^9}, 3.553449924029253*^9, {
   3.5534499675877447`*^9, 3.553449985094746*^9}, {3.5534500611300945`*^9, 
   3.553450154860456*^9}, 3.553452923217797*^9, {3.5534529926017656`*^9, 
   3.553453317493348*^9}, {3.5534533506382437`*^9, 3.553453422517355*^9}, {
   3.55345366754637*^9, 3.5534537028813915`*^9}, 3.553454458970637*^9, {
   3.553455308662236*^9, 3.5534553230880613`*^9}, {3.5534553634873724`*^9, 
   3.5534554417308474`*^9}, {3.5534554843712864`*^9, 3.553455521394404*^9}, {
   3.5534555800707603`*^9, 3.5534556502397738`*^9}, {3.553455741844013*^9, 
   3.553455799820329*^9}, {3.5534560145256095`*^9, 3.5534560239861507`*^9}, 
   3.5534560693197436`*^9, {3.5534561090710173`*^9, 3.5534561114951563`*^9}, {
   3.5534561557756886`*^9, 3.5534561769579*^9}, {3.5534562954016747`*^9, 
   3.553456361204438*^9}, {3.553456423109979*^9, 3.5534564231999846`*^9}, {
   3.5534566494049225`*^9, 3.553456751970789*^9}, 3.5534567850346804`*^9, {
   3.553456838929763*^9, 3.5534568997122393`*^9}, {3.553457006073323*^9, 
   3.5534570269435167`*^9}, {3.5534570754402905`*^9, 3.553457167602562*^9}, {
   3.553457198528331*^9, 3.5534574758341913`*^9}, {3.5534580697551622`*^9, 
   3.553458070224189*^9}, {3.5534603039319496`*^9, 3.5534603090412416`*^9}, {
   3.553460381828405*^9, 3.5534604581037674`*^9}, {3.553460569794156*^9, 
   3.5534605748164434`*^9}, {3.5534607041958437`*^9, 3.553460724975032*^9}, {
   3.553461364802628*^9, 3.5534613772433395`*^9}, {3.553461410537244*^9, 
   3.553461454076734*^9}, 3.553462742143407*^9, 3.5534633382995057`*^9, {
   3.553463843737415*^9, 3.5534638673537655`*^9}, {3.5534639593530273`*^9, 
   3.553463962415203*^9}, 3.5534641059194107`*^9, {3.5538418156604805`*^9, 
   3.553841838717321*^9}, 3.5968864724395943`*^9, {3.59688709302612*^9, 
   3.59688709609029*^9}, {3.596887137683671*^9, 3.5968871595129204`*^9}, {
   3.5968871921537895`*^9, 3.596887247698968*^9}, {3.596888499926647*^9, 
   3.59688850318683*^9}, {3.5969072304701004`*^9, 3.596907246712031*^9}, {
   3.59690738926219*^9, 3.596907419720933*^9}, {3.6062135945439205`*^9, 
   3.606213608119691*^9}, {3.6062136827989397`*^9, 3.606213689505315*^9}, {
   3.606213756176103*^9, 3.6062138213108025`*^9}, 3.60621390494256*^9, 
   3.606214035322962*^9, {3.6062141515385637`*^9, 3.606214152131598*^9}, 
   3.6062151606988945`*^9, 3.6062189701053114`*^9}],

Cell[TextData[{
 "Re-compile the rule function ",
 StyleBox["ruleFunc", "Input"],
 " will give a different set of ",
 StyleBox["seedStore", "Input"],
 " thus a different growth path."
}], "Text",
 CellChangeTimes->{{3.6062161829959784`*^9, 3.6062162608113937`*^9}}],

Cell["\<\
Now everything is ready, let\[CloseCurlyQuote]s grow a snowflake from the \
beginning! :D\
\>", "Text",
 CellChangeTimes->{{3.606215719980668*^9, 3.606215744724079*^9}, {
  3.606215830515953*^9, 3.6062158339481483`*^9}, {3.6062162837166944`*^9, 
  3.60621629190716*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataSet", "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"rule", ",", "\[IndentingNewLine]", 
        RowBox[{"initM", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {"0", "0", "0"},
              {"0", "1", "0"},
              {"0", "0", "0"}
             },
             
             GridBoxDividers->{
              "Columns" -> {False, {True}, False}, "ColumnsIndexed" -> {}, 
               "Rows" -> {False, {True}, False}, "RowsIndexed" -> {}}], 
            "\[NoBreak]", ")"}], ",", "0"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"rspec", "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"tmin", "=", "0"}], ",", 
        RowBox[{"tmax", "=", "100"}], ",", 
        RowBox[{"dt", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rule", "=", 
        RowBox[{"{", 
         RowBox[{"ruleFunc", ",", 
          RowBox[{"{", "}"}], ",", "rspec"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"CellularAutomaton", "[", 
        RowBox[{"rule", ",", "initM", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"tmin", ",", "tmax", ",", "dt"}], "}"}], "}"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.606213926193761*^9, 3.606213959642661*^9}, {
   3.606213999330917*^9, 3.60621400000996*^9}, {3.6062140899240637`*^9, 
   3.6062140970834703`*^9}, {3.6062141613871226`*^9, 3.6062141660913897`*^9}, 
   3.606214396195463*^9, 3.606215131378229*^9, {3.606215167243266*^9, 
   3.606215167846301*^9}, {3.60621566280142*^9, 3.6062156798093853`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "32.13547799999999909914549789391458034515`7.527584677498609", ",", 
   "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.6062156746890945`*^9, 3.606215731761343*^9, 
  3.606279668861761*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Animate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Rotate", "[", 
    RowBox[{
     RowBox[{"displayfunc", "[", 
      RowBox[{
       RowBox[{
       "dataSet", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], ",",
        ".8"}], "]"}], ",", 
     RowBox[{"90", "\[Degree]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "[", "dataSet", "]"}], ",", "1"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"AnimationDirection", "\[Rule]", "ForwardBackward"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"AnimationRunning", "\[Rule]", "False"}], ",", 
   RowBox[{"DisplayAllSteps", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.606215268773034*^9, 3.606215273193286*^9}, {
   3.6062153048190837`*^9, 3.606215376646164*^9}, {3.6062155078886194`*^9, 
   3.6062155670149784`*^9}, {3.6062156045451107`*^9, 3.6062156046871233`*^9}, 
   3.6062191870056334`*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`k$$ = 35, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`k$$], 1, 101, 1}}, Typeset`size$$ = {
    314., {177., 183.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`k$3366$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`k$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`k$$, $CellContext`k$3366$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Rotate[
        $CellContext`displayfunc[
         Part[$CellContext`dataSet, $CellContext`k$$], 0.8], 90 Degree], 
      "Specifications" :> {{$CellContext`k$$, 1, 101, 1, AnimationDirection -> 
         ForwardBackward, AnimationRunning -> False, DisplayAllSteps -> True, 
         AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{363., {213., 220.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.6062796775131702`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Possible improvements", "Subsubsection",
 CellChangeTimes->{{3.6062129682533455`*^9, 3.606213000269164*^9}}],

Cell[TextData[{
 "We used a ",
 StyleBox["SeedRandom", "Input"],
 " function in our CA rule function to force the 6-fold rotational symmetry \
and 3 axes of reflection symmetry, and performed the CA calculation on all \
cells. However, this so called ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["D", "6"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " symmetry (http://demonstrations.wolfram.com/DihedralGroupNOfOrder2n/) can \
(and should) be integrated into our model, which will saving 11/12 of the \
calculation."
}], "Text",
 CellChangeTimes->{
  3.606212964814144*^9, {3.606215855972394*^9, 3.6062158961556773`*^9}, {
   3.60621596046033*^9, 3.6062160764119177`*^9}, {3.6062161132840176`*^9, 
   3.6062161422916594`*^9}, {3.6062163242519975`*^9, 3.606216370707637*^9}}],

Cell[TextData[{
 "Also, the randomness of the growth path comes from ",
 StyleBox["seedStore", "Input"],
 ", so to generate a new growth path, we have to re-compile the rule \
function. But with a improved model as described above, this ",
 "constraint will no longer exist."
}], "Text",
 CellChangeTimes->{{3.606216413652076*^9, 3.606216633555569*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Open question", "Subsubsection",
 CellChangeTimes->{{3.606216640595969*^9, 3.6062166471873436`*^9}}],

Cell[TextData[{
 "Can we construct a well-organized structure (like the crystals) from a \
cellular automaton defined on an irregular grid? I believe the answer is yes, \
so the next question would be ",
 StyleBox["how?",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.606216651267581*^9, 3.6062167913395386`*^9}, {
  3.6062168781794662`*^9, 3.606216880387592*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1664, 913},
WindowMargins->{{-9, Automatic}, {Automatic, -8}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 144, 3, 93, "Title"],
Cell[726, 27, 490, 8, 55, "Text"],
Cell[CellGroupData[{
Cell[1241, 39, 125, 1, 36, "Subsubsection"],
Cell[1369, 42, 438, 7, 33, "Text"],
Cell[1810, 51, 1117, 18, 55, "Text"],
Cell[2930, 71, 574, 9, 33, "Text"],
Cell[CellGroupData[{
Cell[3529, 84, 6878, 157, 754, "Input"],
Cell[10410, 243, 28661, 770, 470, "Output"]
}, {2}]],
Cell[39083, 1016, 224, 5, 33, "Text"],
Cell[39310, 1023, 452, 7, 33, "Text"],
Cell[CellGroupData[{
Cell[39787, 1034, 1480, 42, 155, "Input"],
Cell[41270, 1078, 480, 10, 24, "Message"],
Cell[41753, 1090, 261, 7, 32, "Output"]
}, Open  ]],
Cell[42029, 1100, 46722, 1064, 372, InheritFromParent],
Cell[88754, 2166, 585, 10, 55, "Text"],
Cell[CellGroupData[{
Cell[89364, 2180, 1308, 38, 115, "Input"],
Cell[90675, 2220, 1617, 56, 69, "Output"]
}, {2}]],
Cell[92304, 2279, 226, 4, 33, "Text"],
Cell[92533, 2285, 3798, 104, 253, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96368, 2394, 155, 2, 36, "Subsubsection"],
Cell[96526, 2398, 503, 9, 33, "Text"],
Cell[97032, 2409, 6426, 169, 244, "Output"],
Cell[103461, 2580, 1114, 20, 55, "Text"],
Cell[104578, 2602, 315, 10, 32, "Input"],
Cell[104896, 2614, 888, 17, 57, "Text"],
Cell[CellGroupData[{
Cell[105809, 2635, 10950, 206, 361, "Input"],
Cell[116762, 2843, 10670, 208, 132, "Output"]
}, {2}]],
Cell[127444, 3054, 290, 7, 33, "Text"],
Cell[127737, 3063, 1138, 31, 99, "Input"],
Cell[128878, 3096, 423, 12, 32, "Input"],
Cell[129304, 3110, 533, 16, 32, "Input"],
Cell[129840, 3128, 133, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[129998, 3135, 662, 20, 48, "Input"],
Cell[130663, 3157, 14932, 310, 143, "Output"]
}, {2}]],
Cell[145607, 3470, 511, 8, 33, "Text"],
Cell[146121, 3480, 2829, 87, 103, "Text"],
Cell[CellGroupData[{
Cell[148975, 3571, 4057, 95, 164, "Input"],
Cell[153035, 3668, 35674, 761, 462, "Output"]
}, {2}]],
Cell[188721, 4432, 1151, 21, 77, "Text"],
Cell[189875, 4455, 376, 7, 33, "Text"],
Cell[190254, 4464, 1184, 29, 81, "Text"],
Cell[191441, 4495, 8488, 157, 473, "Input"],
Cell[199932, 4654, 265, 7, 33, "Text"],
Cell[200200, 4663, 280, 6, 33, "Text"],
Cell[CellGroupData[{
Cell[200505, 4673, 1857, 45, 254, "Input"],
Cell[202365, 4720, 232, 6, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202634, 4731, 1009, 23, 143, "Input"],
Cell[203646, 4756, 2014, 40, 482, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[205709, 4802, 114, 1, 36, "Subsubsection"],
Cell[205826, 4805, 786, 17, 55, "Text"],
Cell[206615, 4824, 353, 7, 55, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207005, 4836, 106, 1, 36, "Subsubsection"],
Cell[207114, 4839, 375, 8, 34, "Text"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
